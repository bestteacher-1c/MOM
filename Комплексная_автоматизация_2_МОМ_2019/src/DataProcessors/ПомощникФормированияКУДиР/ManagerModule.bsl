#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

Процедура УстановитьСписокОрганизацийНаУСНЗаПериод(СписокОрганизаций, НачалоПериода, КонецПериода, ТекущаяОрганизация) Экспорт
	
	ОрганизацииНаУСН = УчетнаяПолитикаПереопределяемый.ОрганизацииНаУСНЗаПериод(НачалоПериода, КонецПериода);
	СписокОрганизаций.ЗагрузитьЗначения(ОрганизацииНаУСН);
	ТекущаяОрганизацияПрименяетУСН = Не СписокОрганизаций.НайтиПоЗначению(ТекущаяОрганизация) = Неопределено;
	
	Если СписокОрганизаций.Количество() = 1 И Не ТекущаяОрганизацияПрименяетУСН Тогда
		ТекущаяОрганизация = СписокОрганизаций.Получить(0).Значение;
	ИначеЕсли СписокОрганизаций.Количество() > 1 И Не ТекущаяОрганизацияПрименяетУСН ИЛИ СписокОрганизаций.Количество() = 0 Тогда
		ТекущаяОрганизация = ПредопределенноеЗначение("Справочник.Организации.ПустаяСсылка");
	КонецЕсли;		
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли