////////////////////////////////////////////////////////////////////////////////
// Процедуры, используемые для локализации справочника "Объекты эксплуатации".
// 
////////////////////////////////////////////////////////////////////////////////

#Область СлужебныйПрограммныйИнтерфейс

#Область Печать

Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт
	
	//++ Локализация
	
	Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "ОС6") Тогда
		
		УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(
			КоллекцияПечатныхФорм,
			"ОС6",
			НСтр("ru = 'Инвентарная карточка ОС (ОС-6)'"),
			ПечатьОС6_2003(МассивОбъектов, ОбъектыПечати, ПараметрыПечати));
		
	КонецЕсли;
	
	//-- Локализация
	
КонецПроцедуры

#КонецОбласти

#Область ПодключаемыеКоманды

Процедура ДобавитьКомандыСозданияНаОсновании(КомандыСозданияНаОсновании, Параметры) Экспорт

	//++ Локализация
	
	Команда = Документы.ПередачаОСАрендатору2_4.ДобавитьКомандуСоздатьНаОсновании(КомандыСозданияНаОсновании);
	Если Команда <> Неопределено Тогда
		Команда.ВидимостьВФормах = "ФормаЭлемента, ФормаСпискаСоСведениями";
		Команда.РежимЗаписи = "";
	КонецЕсли;
	
	Команда = Документы.ВозвратОСОтАрендатора2_4.ДобавитьКомандуСоздатьНаОсновании(КомандыСозданияНаОсновании);
	Если Команда <> Неопределено Тогда
		Команда.ВидимостьВФормах = "ФормаЭлемента, ФормаСпискаСоСведениями";
		Команда.РежимЗаписи = "";
	КонецЕсли;
	
	Команда = Документы.ПринятиеКУчетуОС.ДобавитьКомандуСоздатьНаОсновании(КомандыСозданияНаОсновании);
	Если Команда <> Неопределено Тогда
		Команда.ВидимостьВФормах = "ФормаЭлемента, ФормаСпискаСоСведениями";
		Команда.РежимЗаписи = "";
	КонецЕсли;
	
	Команда = Документы.ИзменениеСостоянияОС.ДобавитьКомандуСоздатьНаОсновании(КомандыСозданияНаОсновании);
	Если Команда <> Неопределено Тогда
		Команда.ВидимостьВФормах = "ФормаЭлемента, ФормаСпискаСоСведениями";
		Команда.РежимЗаписи = "";
	КонецЕсли;
	
	Команда = Документы.ИзменениеПараметровОС.ДобавитьКомандуСоздатьНаОсновании(КомандыСозданияНаОсновании);
	Если Команда <> Неопределено Тогда
		Команда.ВидимостьВФормах = "ФормаЭлемента, ФормаСпискаСоСведениями";
		Команда.РежимЗаписи = "";
	КонецЕсли;
	
	Команда = Документы.СписаниеОС.ДобавитьКомандуСоздатьНаОсновании(КомандыСозданияНаОсновании);
	Если Команда <> Неопределено Тогда
		Команда.ВидимостьВФормах = "ФормаЭлемента, ФормаСпискаСоСведениями";
		Команда.РежимЗаписи = "";
	КонецЕсли;
	
	Команда = Документы.РегистрацияПорядкаНалогообложенияПоНалогуНаИмущество.ДобавитьКомандуСоздатьНаОсновании(КомандыСозданияНаОсновании);
	Если Команда <> Неопределено Тогда
		Команда.ВидимостьВФормах = "ФормаЭлемента, ФормаСпискаСоСведениями";
		Команда.РежимЗаписи = "";
	КонецЕсли;
	
	
	//-- Локализация
	
КонецПроцедуры

Процедура ДобавитьКомандыПечати(КомандыПечати) Экспорт
	
	//++ Локализация
	
	Если ПравоДоступа("Изменение", Метаданные.Справочники.ОбъектыЭксплуатации) Тогда
		
		КомандаПечати = КомандыПечати.Добавить();
		КомандаПечати.Идентификатор = "ОС6";
		КомандаПечати.Представление = НСтр("ru = 'Инвентарная карточка ОС (ОС-6)'");
		КомандаПечати.ПроверкаПроведенияПередПечатью = Ложь;
		КомандаПечати.СписокФорм = "ФормаЭлемента,ФормаСпискаСоСведениями";
		
	КонецЕсли;
	
	//-- Локализация
	
КонецПроцедуры

Процедура ДобавитьКомандыОтчетов(КомандыОтчетов, Параметры) Экспорт
	
	//++ Локализация
	
	
	//-- Локализация
	
КонецПроцедуры

#КонецОбласти

#Область ФормаЭлемента

Процедура ПриИзмененииРеквизита(ИмяЭлемента, Форма, ДополнительныеПараметры) Экспорт

	//++ Локализация
	
	Элементы = Форма.Элементы;
	
	Если ИмяЭлемента = Элементы.КодПоОКОФ.Имя Тогда
		
		КодОКОФПриИзменении(Форма);
		
	ИначеЕсли ИмяЭлемента = "ОбработатьВыборКодаПоОКОФ" Тогда
		
		ОбработатьВыборКодаПоОКОФ(Форма, ДополнительныеПараметры);
		
	ИначеЕсли ИмяЭлемента = Элементы.ДрагоценныеМатериалыДрагоценныйМатериал.Имя Тогда
		
		ДрагоценныеМатериалыДрагоценныйМатериалПриИзменении(Форма);
		
	КонецЕсли; 
	
	//-- Локализация
	
КонецПроцедуры

Процедура УстановитьВидимостьКомандВводаНаОсновании(Форма, ТаблицаКоманд) Экспорт

	//++ Локализация
	
	Элементы = Форма.Элементы;
	Объект = Форма.Объект;
	
	Если ПолучитьФункциональнуюОпцию("ОтображатьВнеоборотныеАктивы2_2") Тогда
		
		Если ЗначениеЗаполнено(Объект.Ссылка) Тогда
			Организация = УчетОСВызовСервера.ОрганизацияВКоторойОСПринятоКУчету(Объект.Ссылка);
			ПринятКУчету = ЗначениеЗаполнено(Организация);
		Иначе
			ПринятКУчету = Ложь;
			ПринятКЧетуМФУ = Ложь;
		КонецЕсли;
		
		Если ПравоДоступа("Добавление", Метаданные.Документы.ПринятиеКУчетуОС) Тогда
			ВнеоборотныеАктивыСлужебный.УстановитьВидимостьКомандыВводаНаОсновании(
				Элементы, "ПринятиеКУчетуОС", ТаблицаКоманд, НЕ ПринятКУчету);
		КонецЕсли;

		Если ПравоДоступа("Добавление", Метаданные.Документы.ИзменениеСостоянияОС) Тогда
			ВнеоборотныеАктивыСлужебный.УстановитьВидимостьКомандыВводаНаОсновании(
				Элементы, "ИзменениеСостоянияОС", ТаблицаКоманд, ПринятКУчету);
		КонецЕсли;
		
		Если ПравоДоступа("Добавление", Метаданные.Документы.ИзменениеПараметровОС) Тогда
			ВнеоборотныеАктивыСлужебный.УстановитьВидимостьКомандыВводаНаОсновании(
				Элементы, "ИзменениеПараметровОС", ТаблицаКоманд, ПринятКУчету);
		КонецЕсли;
		
		Если ПравоДоступа("Добавление", Метаданные.Документы.СписаниеОС) Тогда
			ВнеоборотныеАктивыСлужебный.УстановитьВидимостьКомандыВводаНаОсновании(
				Элементы, "СписаниеОС", ТаблицаКоманд, ПринятКУчету);
		КонецЕсли;
		
		
	КонецЕсли;
	
	//-- Локализация
	
КонецПроцедуры

Процедура ЗаполнитьСведенияОбУчете(Форма, ПредставлениеСведений) Экспорт

	//++ Локализация
	
	Элементы = Форма.Элементы;
	Объект = Форма.Объект;
	
	ВнеоборотныеАктивыКлиентСервер.ЗаполнитьСведенияЭлемента(Элементы.СведенияПринятКУчету2, ПредставлениеСведений.СведенияПринятКУчету2);
	ВнеоборотныеАктивыКлиентСервер.ЗаполнитьСведенияЭлемента(Элементы.СведенияСрокИспользования2, ПредставлениеСведений.СведенияСрокИспользования2);
	ВнеоборотныеАктивыКлиентСервер.ЗаполнитьСведенияЭлемента(Элементы.СведенияСрокИспользования3, ПредставлениеСведений.СведенияСрокИспользования3);

	//-- Локализация
	
КонецПроцедуры

Процедура ЗаполнитьСтоимостьИАмортизацию(Форма, СведенияОбУчете, СтоимостьИАмортизация) Экспорт

	//++ Локализация
	
	Элементы = Форма.Элементы;
	Объект = Форма.Объект;

	ПлательщикНалогаНаПрибыль = УчетнаяПолитика.ПлательщикНалогаНаПрибыль(СведенияОбУчете.Организация, ТекущаяДатаСеанса());
	
	СтоимостьИАмортизация = ВнеоборотныеАктивы.СтоимостьИАмортизацияОС(Объект.Ссылка);
	
	Если СведенияОбУчете <> Неопределено
		И СведенияОбУчете.СостояниеБУ = Перечисления.СостоянияОС.ПринятоКЗабалансовомуУчету Тогда
		
		Форма.ВосстановительнаяСтоимостьБУ = СтоимостьИАмортизация.ЗалоговаяСтоимость;
	Иначе	
		Форма.ВосстановительнаяСтоимостьБУ = СтоимостьИАмортизация.СтоимостьРегл;
	КонецЕсли; 
	
	Форма.ВосстановительнаяСтоимостьБУЦФ = СтоимостьИАмортизация.СтоимостьЦФ;
	Форма.ВосстановительнаяСтоимостьВР   = СтоимостьИАмортизация.СтоимостьВР;
	Форма.ВосстановительнаяСтоимостьВРЦФ = СтоимостьИАмортизация.СтоимостьВРЦФ;
	Форма.ВосстановительнаяСтоимостьНУ   = СтоимостьИАмортизация.СтоимостьНУ;
	Форма.ВосстановительнаяСтоимостьНУЦФ = СтоимостьИАмортизация.СтоимостьНУЦФ;
	Форма.ВосстановительнаяСтоимостьПР   = СтоимостьИАмортизация.СтоимостьПР;
	Форма.ВосстановительнаяСтоимостьПРЦФ = СтоимостьИАмортизация.СтоимостьПРЦФ;
	Форма.ВосстановительнаяСтоимостьУУЦФ = 0;
	
	Форма.НакопленнаяАмортизацияБУЦФ = СтоимостьИАмортизация.АмортизацияЦФ;
	Форма.НакопленнаяАмортизацияВР   = СтоимостьИАмортизация.АмортизацияВР;
	Форма.НакопленнаяАмортизацияВРЦФ = СтоимостьИАмортизация.АмортизацияВРЦФ;
	Форма.НакопленнаяАмортизацияНУ   = СтоимостьИАмортизация.АмортизацияНУ;
	Форма.НакопленнаяАмортизацияНУЦФ = СтоимостьИАмортизация.АмортизацияНУЦФ;
	Форма.НакопленнаяАмортизацияПР   = СтоимостьИАмортизация.АмортизацияПР;
	Форма.НакопленнаяАмортизацияПРЦФ = СтоимостьИАмортизация.АмортизацияПРЦФ;
	Форма.НакопленнаяАмортизацияУУЦФ = 0;
	
	Если СведенияОбУчете <> Неопределено
		И СведенияОбУчете.СостояниеБУ = Перечисления.СостоянияОС.ПринятоКЗабалансовомуУчету Тогда
		
		Форма.ОстаточнаяСтоимостьБУ = СтоимостьИАмортизация.ЗалоговаяСтоимость;
	Иначе
		Форма.ОстаточнаяСтоимостьБУ = СтоимостьИАмортизация.СтоимостьРегл - СтоимостьИАмортизация.АмортизацияРегл;
	КонецЕсли;
	
	Форма.ОстаточнаяСтоимостьБУЦФ = СтоимостьИАмортизация.СтоимостьЦФ   - СтоимостьИАмортизация.АмортизацияЦФ;
	Форма.ОстаточнаяСтоимостьВР   = СтоимостьИАмортизация.СтоимостьВР   - СтоимостьИАмортизация.АмортизацияВР;
	Форма.ОстаточнаяСтоимостьВРЦФ = СтоимостьИАмортизация.СтоимостьВРЦФ - СтоимостьИАмортизация.АмортизацияВРЦФ;
	Форма.ОстаточнаяСтоимостьНУ   = СтоимостьИАмортизация.СтоимостьНУ   - СтоимостьИАмортизация.АмортизацияНУ;
	Форма.ОстаточнаяСтоимостьНУЦФ = СтоимостьИАмортизация.СтоимостьНУЦФ - СтоимостьИАмортизация.АмортизацияНУЦФ;
	Форма.ОстаточнаяСтоимостьПР   = СтоимостьИАмортизация.СтоимостьПР   - СтоимостьИАмортизация.АмортизацияПР;
	Форма.ОстаточнаяСтоимостьПРЦФ = СтоимостьИАмортизация.СтоимостьПРЦФ - СтоимостьИАмортизация.АмортизацияПРЦФ;
	Форма.ОстаточнаяСтоимостьУУЦФ = 0;
	
	Если НЕ ПлательщикНалогаНаПрибыль Тогда
		Элементы.ВосстановительнаяСтоимостьНУ.Видимость   = Ложь;
		Элементы.ВосстановительнаяСтоимостьПР.Видимость   = Ложь;
		Элементы.ВосстановительнаяСтоимостьВР.Видимость   = Ложь;
		Элементы.НакопленнаяАмортизацияНУ.Видимость       = Ложь;
		Элементы.НакопленнаяАмортизацияПР.Видимость       = Ложь;
		Элементы.НакопленнаяАмортизацияВР.Видимость       = Ложь;
		Элементы.ОстаточнаяСтоимостьНУ.Видимость          = Ложь;
		Элементы.ОстаточнаяСтоимостьПР.Видимость          = Ложь;
		Элементы.ОстаточнаяСтоимостьВР.Видимость          = Ложь;
		Элементы.ДекорацияЗаголовокНУ.Видимость           = Ложь;
		Элементы.ДекорацияЗаголовокВР.Видимость           = Ложь;
		Элементы.ДекорацияЗаголовокПР.Видимость           = Ложь;
	КонецЕсли; 
	
	Если СтоимостьИАмортизация.СтоимостьЦФ <> 0
		ИЛИ СтоимостьИАмортизация.СтоимостьВРЦФ <> 0
		ИЛИ СтоимостьИАмортизация.СтоимостьНУЦФ <> 0
		ИЛИ СтоимостьИАмортизация.СтоимостьПРЦФ <> 0
		ИЛИ СтоимостьИАмортизация.АмортизацияЦФ <> 0
		ИЛИ СтоимостьИАмортизация.АмортизацияВРЦФ <> 0
		ИЛИ СтоимостьИАмортизация.АмортизацияНУЦФ <> 0
		ИЛИ СтоимостьИАмортизация.АмортизацияПРЦФ <> 0 Тогда
		
		Элементы.ГруппаТекущаяСтоимостьЗаголовок.Заголовок       = НСтр("ru = 'Собственные средства:'");
		Элементы.ГруппаНакопленнаяАмортизацияЗаголовок.Заголовок = НСтр("ru = 'Собственные средства:'");
		Элементы.ГруппаОстаточнаяСтоимостьЗаголовок.Заголовок    = НСтр("ru = 'Собственные средства:'");
		
		Элементы.ГруппаТекущаяСтоимость.ОтображатьЗаголовок        = Истина;
		Элементы.ГруппаНакопленнаяАмортизация.ОтображатьЗаголовок  = Истина;
		Элементы.ГруппаОстаточнаяСтоимость.ОтображатьЗаголовок     = Истина;
		
		Элементы.ГруппаТекущаяСтоимостьЗаголовокЦФ.Видимость       = Истина;
		Элементы.ГруппаНакопленнаяАмортизацияЗаголовокЦФ.Видимость = Истина;
		Элементы.ГруппаОстаточнаяСтоимостьЗаголовокЦФ.Видимость    = Истина;
		
		Элементы.ВосстановительнаяСтоимостьУУЦФ.Видимость   = Истина;
		Элементы.ВосстановительнаяСтоимостьБУЦФ.Видимость   = Истина;
		Элементы.ВосстановительнаяСтоимостьНУЦФ.Видимость   = ПлательщикНалогаНаПрибыль;
		Элементы.ВосстановительнаяСтоимостьПРЦФ.Видимость   = ПлательщикНалогаНаПрибыль;
		Элементы.ВосстановительнаяСтоимостьВРЦФ.Видимость   = ПлательщикНалогаНаПрибыль;
		Элементы.НакопленнаяАмортизацияВРЦФ.Видимость       = ПлательщикНалогаНаПрибыль;
		Элементы.НакопленнаяАмортизацияПРЦФ.Видимость       = ПлательщикНалогаНаПрибыль;
		Элементы.НакопленнаяАмортизацияНУЦФ.Видимость       = ПлательщикНалогаНаПрибыль;
		Элементы.НакопленнаяАмортизацияБУЦФ.Видимость       = Истина;
		Элементы.НакопленнаяАмортизацияУУЦФ.Видимость       = Истина;
		Элементы.ОстаточнаяСтоимостьУУЦФ.Видимость          = Истина;
		Элементы.ОстаточнаяСтоимостьБУЦФ.Видимость          = Истина;
		Элементы.ОстаточнаяСтоимостьНУЦФ.Видимость          = ПлательщикНалогаНаПрибыль;
		Элементы.ОстаточнаяСтоимостьПРЦФ.Видимость          = ПлательщикНалогаНаПрибыль;
		Элементы.ОстаточнаяСтоимостьВРЦФ.Видимость          = ПлательщикНалогаНаПрибыль;
		
	Иначе
		
		Элементы.ГруппаТекущаяСтоимостьЗаголовок.Заголовок       = НСтр("ru = 'Восстановительная стоимость:'");
		Элементы.ГруппаНакопленнаяАмортизацияЗаголовок.Заголовок = НСтр("ru = 'Накопленная амортизация:'");
		Элементы.ГруппаОстаточнаяСтоимостьЗаголовок.Заголовок    = НСтр("ru = 'Остаточная стоимость:'");
		
		Элементы.ГруппаТекущаяСтоимость.ОтображатьЗаголовок        = Ложь;
		Элементы.ГруппаНакопленнаяАмортизация.ОтображатьЗаголовок  = Ложь;
		Элементы.ГруппаОстаточнаяСтоимость.ОтображатьЗаголовок     = Ложь;
		
		Элементы.ГруппаТекущаяСтоимостьЗаголовокЦФ.Видимость       = Ложь;
		Элементы.ГруппаНакопленнаяАмортизацияЗаголовокЦФ.Видимость = Ложь;
		Элементы.ГруппаОстаточнаяСтоимостьЗаголовокЦФ.Видимость    = Ложь;
		
		Элементы.ВосстановительнаяСтоимостьУУЦФ.Видимость   = Ложь;
		Элементы.ВосстановительнаяСтоимостьБУЦФ.Видимость   = Ложь;
		Элементы.ВосстановительнаяСтоимостьНУЦФ.Видимость   = Ложь;
		Элементы.ВосстановительнаяСтоимостьПРЦФ.Видимость   = Ложь;
		Элементы.ВосстановительнаяСтоимостьВРЦФ.Видимость   = Ложь;
		Элементы.НакопленнаяАмортизацияВРЦФ.Видимость       = Ложь;
		Элементы.НакопленнаяАмортизацияПРЦФ.Видимость       = Ложь;
		Элементы.НакопленнаяАмортизацияНУЦФ.Видимость       = Ложь;
		Элементы.НакопленнаяАмортизацияБУЦФ.Видимость       = Ложь;
		Элементы.НакопленнаяАмортизацияУУЦФ.Видимость       = Ложь;
		Элементы.ОстаточнаяСтоимостьУУЦФ.Видимость          = Ложь;
		Элементы.ОстаточнаяСтоимостьБУЦФ.Видимость          = Ложь;
		Элементы.ОстаточнаяСтоимостьНУЦФ.Видимость          = Ложь;
		Элементы.ОстаточнаяСтоимостьПРЦФ.Видимость          = Ложь;
		Элементы.ОстаточнаяСтоимостьВРЦФ.Видимость          = Ложь;
		
	КонецЕсли; 
	
	//-- Локализация
	
КонецПроцедуры

Процедура ПриЧтенииСозданииНаСервере(Форма) Экспорт

	//++ Локализация
	
	Элементы = Форма.Элементы;
	
	ВалютаУпр = Константы.ВалютаУправленческогоУчета.Получить();
	ВалютаРегл = Константы.ВалютаРегламентированногоУчета.Получить();
	Если ВалютаУпр <> ВалютаРегл Тогда
		Элементы.ДекорацияЗаголовокНУ.Заголовок = СтрШаблон(НСтр("ru = 'НУ (%1):'"), Строка(ВалютаРегл));
		Элементы.ДекорацияЗаголовокПР.Заголовок = СтрШаблон(НСтр("ru = 'ПР (%1):'"), Строка(ВалютаРегл));
		Элементы.ДекорацияЗаголовокВР.Заголовок = СтрШаблон(НСтр("ru = 'ВР (%1):'"), Строка(ВалютаРегл));
	КонецЕсли; 
	
	ЗаполнитьПодсказкуКодОКОФ(Форма);
	
	//-- Локализация
	
КонецПроцедуры

Процедура УстановитьУсловноеОформление(Форма) Экспорт

	//++ Локализация
	
	Объект = Форма.Объект;
	Элементы = Форма.Элементы;
	УсловноеОформление = Форма.УсловноеОформление;
	
	
	//-- Локализация
	
КонецПроцедуры
 
#КонецОбласти

#Область ФормаСписка

Процедура ДополнитьСведения2_4(ВнеоборотныйАктив, СведенияОбУчете, СтоимостьИАмортизация, МассивСумм, Сведения2_4) Экспорт

	//++ Локализация
	
	Если СведенияОбУчете <> Неопределено Тогда
		ПлательщикНалогаНаПрибыль = УчетнаяПолитика.ПлательщикНалогаНаПрибыль(СведенияОбУчете.Организация, ТекущаяДатаСеанса());
	Иначе
		ПлательщикНалогаНаПрибыль = Ложь;
	КонецЕсли; 

	ВалютаРегл = Константы.ВалютаРегламентированногоУчета.Получить();
	
	Если ВнеоборотныеАктивыСлужебный.ВедетсяРегламентированныйУчетВНА() Тогда
		
		// БУ
		ДанныеУчета = Новый Структура;
		ДанныеУчета.Вставить("Учет", "БУ");
		ДанныеУчета.Вставить("Валюта", ВалютаРегл);
		
		Если СведенияОбУчете <> Неопределено
			И СведенияОбУчете.СостояниеБУ = Перечисления.СостоянияОС.ПринятоКЗабалансовомуУчету Тогда
			ДанныеУчета.Вставить("ВосстановительнаяСтоимость", СтоимостьИАмортизация.ЗалоговаяСтоимость);
			ДанныеУчета.Вставить("НакопленнаяАмортизация", 0);
			ДанныеУчета.Вставить("ОстаточнаяСтоимость", СтоимостьИАмортизация.ЗалоговаяСтоимость);
		Иначе
			ДанныеУчета.Вставить("ВосстановительнаяСтоимость", СтоимостьИАмортизация.СтоимостьРегл + СтоимостьИАмортизация.СтоимостьЦФ);
			ДанныеУчета.Вставить("НакопленнаяАмортизация", СтоимостьИАмортизация.АмортизацияРегл + СтоимостьИАмортизация.АмортизацияЦФ);
			
			ДанныеУчета.Вставить("ОстаточнаяСтоимость", СтоимостьИАмортизация.СтоимостьРегл 
															+ СтоимостьИАмортизация.СтоимостьЦФ 
															- СтоимостьИАмортизация.АмортизацияРегл 
															- СтоимостьИАмортизация.АмортизацияЦФ);
		КонецЕсли; 
		
		МассивСумм.Добавить(ДанныеУчета);
		
	КонецЕсли; 
	
	Если ПолучитьФункциональнуюОпцию("ИспользоватьРеглУчет")
		И ПлательщикНалогаНаПрибыль
		И (СведенияОбУчете = Неопределено
			ИЛИ СведенияОбУчете.СостояниеБУ <> Перечисления.СостоянияОС.ПринятоКЗабалансовомуУчету) Тогда
			
		// НУ
		ДанныеУчета = Новый Структура;
		ДанныеУчета.Вставить("Учет", "НУ");
		ДанныеУчета.Вставить("Валюта", ВалютаРегл);
		ДанныеУчета.Вставить("ВосстановительнаяСтоимость", СтоимостьИАмортизация.СтоимостьНУ + СтоимостьИАмортизация.СтоимостьНУЦФ);
		ДанныеУчета.Вставить("НакопленнаяАмортизация", СтоимостьИАмортизация.АмортизацияНУ + СтоимостьИАмортизация.АмортизацияНУЦФ);
		
		ДанныеУчета.Вставить("ОстаточнаяСтоимость", СтоимостьИАмортизация.СтоимостьНУ 
														+ СтоимостьИАмортизация.СтоимостьНУЦФ 
														- СтоимостьИАмортизация.АмортизацияНУ 
														- СтоимостьИАмортизация.АмортизацияНУЦФ);
		МассивСумм.Добавить(ДанныеУчета);
		
		Если ПолучитьФункциональнуюОпцию("ВедетсяУчетПостоянныхИВременныхРазниц") Тогда
			
			// ПР
			ДанныеУчета = Новый Структура;
			ДанныеУчета.Вставить("Учет", "ПР");
			ДанныеУчета.Вставить("Валюта", ВалютаРегл);
			ДанныеУчета.Вставить("ВосстановительнаяСтоимость", СтоимостьИАмортизация.СтоимостьПР + СтоимостьИАмортизация.СтоимостьПРЦФ);
			ДанныеУчета.Вставить("НакопленнаяАмортизация", СтоимостьИАмортизация.АмортизацияПР + СтоимостьИАмортизация.АмортизацияПРЦФ);
			
			ДанныеУчета.Вставить("ОстаточнаяСтоимость", СтоимостьИАмортизация.СтоимостьПР 
															+ СтоимостьИАмортизация.СтоимостьПРЦФ 
															- СтоимостьИАмортизация.АмортизацияПР 
															- СтоимостьИАмортизация.АмортизацияПРЦФ);
			МассивСумм.Добавить(ДанныеУчета);
			
			// ВР
			ДанныеУчета = Новый Структура;
			ДанныеУчета.Вставить("Учет", "ВР");
			ДанныеУчета.Вставить("Валюта", ВалютаРегл);
			ДанныеУчета.Вставить("ВосстановительнаяСтоимость", СтоимостьИАмортизация.СтоимостьВР + СтоимостьИАмортизация.СтоимостьВРЦФ);
			ДанныеУчета.Вставить("НакопленнаяАмортизация", СтоимостьИАмортизация.АмортизацияВР + СтоимостьИАмортизация.АмортизацияВРЦФ);
			ДанныеУчета.Вставить("ОстаточнаяСтоимость", СтоимостьИАмортизация.СтоимостьВР 
															+ СтоимостьИАмортизация.СтоимостьВРЦФ 
															- СтоимостьИАмортизация.АмортизацияВР 
															- СтоимостьИАмортизация.АмортизацияВРЦФ);
			МассивСумм.Добавить(ДанныеУчета);
			
		КонецЕсли; 
		
	КонецЕсли; 
	
	РеквизитыОбъекта = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(ВнеоборотныйАктив, "ГруппаОС,КодПоОКОФ,АмортизационнаяГруппа");
	Если ЗначениеЗаполнено(РеквизитыОбъекта.ГруппаОС) Тогда
		ТекстСтроки = СтрШаблон(НСтр("ru = 'Группа ОС: %1'"), РеквизитыОбъекта.ГруппаОС);
		СведенияГруппаОС = Новый ФорматированнаяСтрока(ТекстСтроки);
		Сведения2_4.Вставить("СведенияГруппаОС", ОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(СведенияГруппаОС));
	Иначе
		Сведения2_4.Вставить("СведенияГруппаОС", Неопределено);
	КонецЕсли; 
	Если ЗначениеЗаполнено(РеквизитыОбъекта.КодПоОКОФ) Тогда
		ТекстСтроки = СтрШаблон(НСтр("ru = 'Код по ОКОФ: %1'"), РеквизитыОбъекта.КодПоОКОФ);
		СведенияКодПоОКОФ = Новый ФорматированнаяСтрока(ТекстСтроки);
		Сведения2_4.Вставить("СведенияКодПоОКОФ", ОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(СведенияКодПоОКОФ));
	Иначе
		Сведения2_4.Вставить("СведенияКодПоОКОФ", Неопределено);
	КонецЕсли; 
	Если ЗначениеЗаполнено(РеквизитыОбъекта.АмортизационнаяГруппа) Тогда
		ТекстСтроки = СтрШаблон(НСтр("ru = 'Амортизационная группа: %1'"), РеквизитыОбъекта.АмортизационнаяГруппа);
		СведенияАмортизационнаяГруппа = Новый ФорматированнаяСтрока(ТекстСтроки);
		Сведения2_4.Вставить("СведенияАмортизационнаяГруппа", ОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(СведенияАмортизационнаяГруппа));
	Иначе
		Сведения2_4.Вставить("СведенияАмортизационнаяГруппа", Неопределено);
	КонецЕсли; 

	//-- Локализация
	
КонецПроцедуры

Функция ПолучитьСведения2_2(Знач ВнеоборотныйАктив, Знач ОтборОрганизация) Экспорт
	
	Сведения2_2 = Неопределено;
	
	//++ Локализация
	
	УстановитьПривилегированныйРежим(Истина);
	
	ЗначенияПоУмолчанию = Новый Структура;
	ЗначенияПоУмолчанию.Вставить("СтоимостьБУ", 0);
	ЗначенияПоУмолчанию.Вставить("СтоимостьНУ", 0);
	ЗначенияПоУмолчанию.Вставить("СтоимостьПР", 0);
	ЗначенияПоУмолчанию.Вставить("СтоимостьВР", 0);
	ЗначенияПоУмолчанию.Вставить("АмортизацияБУ", 0);
	ЗначенияПоУмолчанию.Вставить("АмортизацияНУ", 0);
	ЗначенияПоУмолчанию.Вставить("АмортизацияПР", 0);
	ЗначенияПоУмолчанию.Вставить("АмортизацияВР", 0);
	ЗначенияПоУмолчанию.Вставить("НачислениеИзноса", Ложь);
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("ВидСубконтоОС", ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.ОсновныеСредства);
	Запрос.УстановитьПараметр("ОтборПоОрганизации", ЗначениеЗаполнено(ОтборОрганизация));
	Запрос.УстановитьПараметр("ОтборОрганизация", ОтборОрганизация);
	Запрос.УстановитьПараметр("ВнеоборотныйАктив", ВнеоборотныйАктив);
	
	Запрос.Текст=
	"ВЫБРАТЬ
	|	ПервоначальныеСведения.ОсновноеСредство КАК ОбъектУчета,
	|	СчетаОтражения.СчетУчета КАК СчетУчета,
	|	СчетаОтражения.СчетНачисленияАмортизации КАК СчетАмортизации,
	|	ЕСТЬNULL(ПараметрыЦелевогоФинансирования.ПрименениеЦелевогоФинансирования, ЛОЖЬ) КАК ПрименениеЦелевогоФинансирования,
	|	ПараметрыЦелевогоФинансирования.СчетУчета КАК СчетУчетаЦФ,
	|	ПараметрыЦелевогоФинансирования.СчетАмортизации КАК СчетАмортизацииЦФ,
	|	ВЫБОР
	|		КОГДА ПервоначальныеСведения.ПорядокПогашенияСтоимости = ЗНАЧЕНИЕ(Перечисление.ПорядокПогашенияСтоимостиОС.НачислениеИзносаПоЕНАОФ)
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК НачислениеИзноса
	|ПОМЕСТИТЬ втАктивыИСчетаУчета
	|ИЗ
	|	РегистрСведений.ПервоначальныеСведенияОСБухгалтерскийУчет.СрезПоследних(, ОсновноеСредство = &ВнеоборотныйАктив) КАК ПервоначальныеСведения
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СчетаБухгалтерскогоУчетаОС.СрезПоследних(
	|				,
	|				ОсновноеСредство = &ВнеоборотныйАктив
	|					И (НЕ &ОтборПООрганизации
	|						ИЛИ Организация = &ОтборОрганизация)) КАК СчетаОтражения
	|		ПО ПервоначальныеСведения.ОсновноеСредство = СчетаОтражения.ОсновноеСредство
	|			И (ВЫБОР
	|				КОГДА &ОтборПООрганизации
	|					ТОГДА ИСТИНА
	|				ИНАЧЕ ПервоначальныеСведения.Организация = СчетаОтражения.Организация
	|			КОНЕЦ)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПараметрыЦелевогоФинансированияОС.СрезПоследних(, ОсновноеСредство = &ВнеоборотныйАктив) КАК ПараметрыЦелевогоФинансирования
	|		ПО ПервоначальныеСведения.ОсновноеСредство = ПараметрыЦелевогоФинансирования.ОсновноеСредство
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	АктивыИСчетаУчета.СчетУчета КАК Счет
	|ПОМЕСТИТЬ втСчетаОстатков
	|ИЗ
	|	втАктивыИСчетаУчета КАК АктивыИСчетаУчета
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	АктивыИСчетаУчета.СчетАмортизации
	|ИЗ
	|	втАктивыИСчетаУчета КАК АктивыИСчетаУчета
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	АктивыИСчетаУчета.СчетУчетаЦФ
	|ИЗ
	|	втАктивыИСчетаУчета КАК АктивыИСчетаУчета
	|ГДЕ
	|	АктивыИСчетаУчета.ПрименениеЦелевогоФинансирования
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	АктивыИСчетаУчета.СчетАмортизацииЦФ
	|ИЗ
	|	втАктивыИСчетаУчета КАК АктивыИСчетаУчета
	|ГДЕ
	|	АктивыИСчетаУчета.ПрименениеЦелевогоФинансирования
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ХозрасчетныйОстатки.Субконто1 КАК ОбъектУчета,
	|	ХозрасчетныйОстатки.Счет КАК Счет,
	|	ХозрасчетныйОстатки.СуммаОстаток КАК СуммаБУ,
	|	ХозрасчетныйОстатки.СуммаНУОстаток КАК СуммаНУ,
	|	ХозрасчетныйОстатки.СуммаПРОстаток КАК СуммаПР,
	|	ХозрасчетныйОстатки.СуммаВРОстаток КАК СуммаВР
	|ПОМЕСТИТЬ втОстатки
	|ИЗ
	|	РегистрБухгалтерии.Хозрасчетный.Остатки(
	|			,
	|			Счет В
	|				(ВЫБРАТЬ
	|					Т.Счет
	|				ИЗ
	|					втСчетаОстатков КАК Т),
	|			&ВидСубконтоОС,
	|			Субконто1 В (&ВнеоборотныйАктив)
	|				И (НЕ &ОтборПООрганизации
	|					ИЛИ Организация = &ОтборОрганизация)) КАК ХозрасчетныйОстатки
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ЕСТЬNULL(Стоимость.СуммаБУ, 0) + ЕСТЬNULL(СтоимостьЦФ.СуммаБУ, 0) КАК СтоимостьБУ,
	|	ЕСТЬNULL(Стоимость.СуммаНУ, 0) + ЕСТЬNULL(СтоимостьЦФ.СуммаНУ, 0) КАК СтоимостьНУ,
	|	ЕСТЬNULL(Стоимость.СуммаПР, 0) + ЕСТЬNULL(СтоимостьЦФ.СуммаПР, 0) КАК СтоимостьПР,
	|	ЕСТЬNULL(Стоимость.СуммаВР, 0) + ЕСТЬNULL(СтоимостьЦФ.СуммаВР, 0) КАК СтоимостьВР,
	|	ЕСТЬNULL(-Амортизация.СуммаБУ, 0) + ЕСТЬNULL(-АмортизацияЦФ.СуммаБУ, 0) КАК АмортизацияБУ,
	|	ЕСТЬNULL(-Амортизация.СуммаНУ, 0) + ЕСТЬNULL(-АмортизацияЦФ.СуммаНУ, 0) КАК АмортизацияНУ,
	|	ЕСТЬNULL(-Амортизация.СуммаПР, 0) + ЕСТЬNULL(-АмортизацияЦФ.СуммаПР, 0) КАК АмортизацияПР,
	|	ЕСТЬNULL(-Амортизация.СуммаВР, 0) + ЕСТЬNULL(-АмортизацияЦФ.СуммаВР, 0) КАК АмортизацияВР,
	|	втАктивыИСчетаУчета.НачислениеИзноса КАК НачислениеИзноса
	|ИЗ
	|	втАктивыИСчетаУчета КАК втАктивыИСчетаУчета
	|		ЛЕВОЕ СОЕДИНЕНИЕ втОстатки КАК Стоимость
	|		ПО втАктивыИСчетаУчета.ОбъектУчета = Стоимость.ОбъектУчета
	|			И втАктивыИСчетаУчета.СчетУчета = Стоимость.Счет
	|		ЛЕВОЕ СОЕДИНЕНИЕ втОстатки КАК Амортизация
	|		ПО втАктивыИСчетаУчета.ОбъектУчета = Амортизация.ОбъектУчета
	|			И втАктивыИСчетаУчета.СчетАмортизации = Амортизация.Счет
	|		ЛЕВОЕ СОЕДИНЕНИЕ втОстатки КАК СтоимостьЦФ
	|		ПО втАктивыИСчетаУчета.ОбъектУчета = СтоимостьЦФ.ОбъектУчета
	|			И втАктивыИСчетаУчета.СчетУчетаЦФ = СтоимостьЦФ.Счет
	|			И втАктивыИСчетаУчета.ПрименениеЦелевогоФинансирования
	|		ЛЕВОЕ СОЕДИНЕНИЕ втОстатки КАК АмортизацияЦФ
	|		ПО втАктивыИСчетаУчета.ОбъектУчета = АмортизацияЦФ.ОбъектУчета
	|			И втАктивыИСчетаУчета.СчетАмортизацииЦФ = АмортизацияЦФ.Счет
	|			И втАктивыИСчетаУчета.ПрименениеЦелевогоФинансирования";
	
	Результат = Запрос.Выполнить();
	Если Не Результат.Пустой() Тогда
		Выборка = Результат.Выбрать();
		Выборка.Следующий();
		ЗаполнитьЗначенияСвойств(ЗначенияПоУмолчанию, Выборка);
	КонецЕсли;
	
	ЗаголовокВалюты = Строка(Константы.ВалютаРегламентированногоУчета.Получить());
	
	Поля = "Представление, СуммаБУ, СуммаНУ, СуммаПР, СуммаВР";
	
	Сведения2_2 = Новый Массив;
	
	Строка = Новый Структура(Поля);
	Строка.Представление = НСтр("ru='Восстановительная стоимость:'");
	Строка.СуммаБУ = ЗначенияПоУмолчанию.СтоимостьБУ;
	Строка.СуммаНУ = ЗначенияПоУмолчанию.СтоимостьНУ;
	Строка.СуммаПР = ЗначенияПоУмолчанию.СтоимостьПР;
	Строка.СуммаВР = ЗначенияПоУмолчанию.СтоимостьВР;
	Сведения2_2.Добавить(Строка);
	
	ЗаголовокАмортизации = НСтр("ru='Накопленная амортизация:'");
	МножительАмортизации = 1;
	Если ЗначенияПоУмолчанию.НачислениеИзноса Тогда
		ЗаголовокАмортизации = НСтр("ru='Накопленный износ:'");
		МножительАмортизации = -1;
	КонецЕсли;
	
	Строка = Новый Структура(Поля);
	Строка.Представление = ЗаголовокАмортизации;
	Строка.СуммаБУ = ЗначенияПоУмолчанию.АмортизацияБУ * МножительАмортизации;
	Строка.СуммаНУ = ЗначенияПоУмолчанию.АмортизацияНУ * МножительАмортизации;
	Строка.СуммаПР = ЗначенияПоУмолчанию.АмортизацияПР * МножительАмортизации;
	Строка.СуммаВР = ЗначенияПоУмолчанию.АмортизацияВР * МножительАмортизации;
	Сведения2_2.Добавить(Строка);
	
	Если Не ЗначенияПоУмолчанию.НачислениеИзноса Тогда
		
		Строка = Новый Структура(Поля);
		Строка.Представление = НСтр("ru='Остаточная стоимость:'");
		Строка.СуммаБУ = ЗначенияПоУмолчанию.СтоимостьБУ-ЗначенияПоУмолчанию.АмортизацияБУ;
		Строка.СуммаНУ = ЗначенияПоУмолчанию.СтоимостьНУ-ЗначенияПоУмолчанию.АмортизацияНУ;
		Строка.СуммаПР = ЗначенияПоУмолчанию.СтоимостьПР-ЗначенияПоУмолчанию.АмортизацияПР;
		Строка.СуммаВР = ЗначенияПоУмолчанию.СтоимостьВР-ЗначенияПоУмолчанию.АмортизацияВР;
		Сведения2_2.Добавить(Строка);
		
	КонецЕсли;
	
	//-- Локализация
	
	Возврат Сведения2_2;
	
КонецФункции

Функция ТекстЗапросаФормыСписка() Экспорт

	ТекстЗапроса = Неопределено;
	
	//++ Локализация
	
	Если ВнеоборотныеАктивы.ИспользуетсяУправлениеВНА_2_4() Тогда
		
		ТекстЗапроса =
		"ВЫБРАТЬ
		|	СправочникОбъектыЭксплуатации.Ссылка,
		|	СправочникОбъектыЭксплуатации.ПометкаУдаления,
		|	СправочникОбъектыЭксплуатации.Родитель,
		|	СправочникОбъектыЭксплуатации.ЭтоГруппа,
		|	СправочникОбъектыЭксплуатации.Код,
		|	СправочникОбъектыЭксплуатации.Наименование,
		|	СправочникОбъектыЭксплуатации.НаименованиеПолное,
		|	СправочникОбъектыЭксплуатации.Изготовитель,
		|	СправочникОбъектыЭксплуатации.ЗаводскойНомер,
		|	СправочникОбъектыЭксплуатации.НомерПаспорта,
		|	СправочникОбъектыЭксплуатации.ДатаВыпуска,
		|	СправочникОбъектыЭксплуатации.КодПоОКОФ КАК КодПоОКОФ,
		|	СправочникОбъектыЭксплуатации.ГруппаОС КАК ГруппаОС,
		|	СправочникОбъектыЭксплуатации.АмортизационнаяГруппа КАК АмортизационнаяГруппа,
		|	СправочникОбъектыЭксплуатации.ШифрПоЕНАОФ КАК ШифрПоЕНАОФ,
		|	СправочникОбъектыЭксплуатации.Комментарий,
		|	СправочникОбъектыЭксплуатации.Расположение,
		|	СправочникОбъектыЭксплуатации.Модель,
		|	СправочникОбъектыЭксплуатации.СерийныйНомер,
		|	СправочникОбъектыЭксплуатации.ИнвентарныйНомер,
		|	МестонахождениеОС.АдресМестонахождения,
		|
		|	ВЫБОР
		|		КОГДА &ОтборПоОрганизации И МестонахождениеОС.Арендатор = &ОтборОрганизация
		|			ТОГДА МестонахождениеОС.МОЛАрендатора
		|		ИНАЧЕ ЕСТЬNULL(МестонахождениеОС.МОЛ, ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка))
		|	КОНЕЦ КАК МОЛ,
		|
		|	ВЫБОР
		|		КОГДА &ОтборПоОрганизации И МестонахождениеОС.Арендатор = &ОтборОрганизация
		|			ТОГДА МестонахождениеОС.ПодразделениеАрендатора
		|		ИНАЧЕ ЕСТЬNULL(МестонахождениеОС.Местонахождение, ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка))
		|	КОНЕЦ КАК Подразделение,		
		|
		|	ВЫБОР
		|		КОГДА &ОтборПоОрганизации И МестонахождениеОС.Арендатор = &ОтборОрганизация
		|			ТОГДА МестонахождениеОС.Арендатор
		|		ИНАЧЕ ЕСТЬNULL(МестонахождениеОС.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) 
		|	КОНЕЦ КАК Организация,
		|
		|	ВЫБОР 
		|		КОГДА СправочникОбъектыЭксплуатации.ЭтоГруппа
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПустаяСсылка)
		|		КОГДА &ОтборПоОрганизации 
		|				И МестонахождениеОС.Арендатор = &ОтборОрганизация
		|				И НЕ ПорядокУчетаОСБУ.Состояние ЕСТЬ NULL
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПринятоКЗабалансовомуУчету)
		|		ИНАЧЕ ЕСТЬNULL(ПорядокУчетаОСБУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету))
		|	КОНЕЦ КАК СостояниеРегл,
		|
		|	ВЫБОР 
		|		КОГДА СправочникОбъектыЭксплуатации.ЭтоГруппа
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПустаяСсылка)
		|		КОГДА &ОтборПоОрганизации 
		|				И МестонахождениеОС.Арендатор = &ОтборОрганизация
		|				И НЕ ПорядокУчетаОСУУ.Состояние ЕСТЬ NULL
		|			ТОГДА ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПринятоКЗабалансовомуУчету)
		|		ИНАЧЕ ЕСТЬNULL(ПорядокУчетаОСУУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету)) 
		|	КОНЕЦ КАК СостояниеУпр,
		|
		|	ЕСТЬNULL(ПервоначальныеСведенияОС.ДатаВводаВЭксплуатациюБУ, ДАТАВРЕМЯ(1, 1, 1)) КАК ДатаПринятияКУчетуРегл,
		|	ЕСТЬNULL(ПервоначальныеСведенияОС.ДатаВводаВЭксплуатациюУУ, ДАТАВРЕМЯ(1, 1, 1)) КАК ДатаПринятияКУчетуУпр,
		|	ВЫБОР
		|		КОГДА НаличиеФайлов.ЕстьФайлы ЕСТЬ NULL ТОГДА 0
		|		КОГДА НаличиеФайлов.ЕстьФайлы ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ЕстьФайлы
		|ИЗ
		|	Справочник.ОбъектыЭксплуатации КАК СправочникОбъектыЭксплуатации
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НаличиеФайлов КАК НаличиеФайлов
		|		ПО СправочникОбъектыЭксплуатации.Ссылка = НаличиеФайлов.ОбъектСФайлами
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.МестонахождениеОС.СрезПоследних КАК МестонахождениеОС
		|		ПО (МестонахождениеОС.ОсновноеСредство = СправочникОбъектыЭксплуатации.Ссылка)
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПервоначальныеСведенияОС.СрезПоследних КАК ПервоначальныеСведенияОС
		|		ПО ПервоначальныеСведенияОС.ОсновноеСредство = МестонахождениеОС.ОсновноеСредство
		|			И ПервоначальныеСведенияОС.Организация = МестонахождениеОС.Организация
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокУчетаОСБУ.СрезПоследних КАК ПорядокУчетаОСБУ
		|		ПО (ПорядокУчетаОСБУ.ОсновноеСредство = МестонахождениеОС.ОсновноеСредство)
		|			И (ПорядокУчетаОСБУ.Организация = МестонахождениеОС.Организация)
		|
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокУчетаОСУУ.СрезПоследних КАК ПорядокУчетаОСУУ
		|		ПО (ПорядокУчетаОСУУ.ОсновноеСредство = МестонахождениеОС.ОсновноеСредство)
		|			И (ПорядокУчетаОСУУ.Организация = МестонахождениеОС.Организация)
		|ГДЕ
		|	(НЕ &ОтборПоОрганизации
		|		ИЛИ ВЫБОР
		|				КОГДА &ОтборПоОрганизации И МестонахождениеОС.Арендатор = &ОтборОрганизация
		|					ТОГДА МестонахождениеОС.Арендатор
		|				ИНАЧЕ ЕСТЬNULL(МестонахождениеОС.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) 
		|			КОНЕЦ = &ОтборОрганизация)
		|
		|	И (&Состояние = ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПустаяСсылка)
		|		ИЛИ ВЫБОР 
		|				КОГДА СправочникОбъектыЭксплуатации.ЭтоГруппа
		|					ТОГДА ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПустаяСсылка)
		|				КОГДА &ОтборПоОрганизации И МестонахождениеОС.Арендатор = &ОтборОрганизация
		|					ТОГДА ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПринятоКЗабалансовомуУчету)
		|				ИНАЧЕ ЕСТЬNULL(ПорядокУчетаОСБУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету))
		|			КОНЕЦ = &Состояние
		|		ИЛИ ВЫБОР 
		|				КОГДА СправочникОбъектыЭксплуатации.ЭтоГруппа
		|					ТОГДА ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПустаяСсылка)
		|				КОГДА &ОтборПоОрганизации И МестонахождениеОС.Арендатор = &ОтборОрганизация
		|					ТОГДА ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПринятоКЗабалансовомуУчету)
		|				ИНАЧЕ ЕСТЬNULL(ПорядокУчетаОСУУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету))
		|			КОНЕЦ = &Состояние)";
		
	Иначе
		
		ТекстЗапроса =
		"ВЫБРАТЬ
		|	СправочникОбъектыЭксплуатации.Ссылка,
		|	СправочникОбъектыЭксплуатации.ПометкаУдаления,
		|	СправочникОбъектыЭксплуатации.Родитель,
		|	СправочникОбъектыЭксплуатации.ЭтоГруппа,
		|	СправочникОбъектыЭксплуатации.Код,
		|	СправочникОбъектыЭксплуатации.Наименование,
		|	СправочникОбъектыЭксплуатации.НаименованиеПолное,
		|	СправочникОбъектыЭксплуатации.Изготовитель,
		|	СправочникОбъектыЭксплуатации.ЗаводскойНомер,
		|	СправочникОбъектыЭксплуатации.НомерПаспорта,
		|	СправочникОбъектыЭксплуатации.ДатаВыпуска,
		|	СправочникОбъектыЭксплуатации.КодПоОКОФ КАК КодПоОКОФ,
		|	СправочникОбъектыЭксплуатации.ГруппаОС КАК ГруппаОС,
		|	СправочникОбъектыЭксплуатации.АмортизационнаяГруппа КАК АмортизационнаяГруппа,
		|	СправочникОбъектыЭксплуатации.ШифрПоЕНАОФ КАК ШифрПоЕНАОФ,
		|	СправочникОбъектыЭксплуатации.Комментарий,
		|	СправочникОбъектыЭксплуатации.Расположение,
		|	СправочникОбъектыЭксплуатации.Модель,
		|	СправочникОбъектыЭксплуатации.СерийныйНомер,
		|	МестонахождениеОСБухгалтерскийУчетСрезПоследних.АдресМестонахождения,
		|	ЕСТЬNULL(СостоянияОСОрганизацийСрезПоследних.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
		|	ЕСТЬNULL(СостоянияОСОрганизацийСрезПоследних.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету)) КАК СостояниеРегл,
		|	ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПустаяСсылка) КАК СостояниеУпр,
		|	СправочникОбъектыЭксплуатации.ИнвентарныйНомер,
		|	ВЫБОР ЕСТЬNULL(СостоянияОСОрганизацийСрезПоследних.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету))
		|		КОГДА ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПринятоКУчету)
		|			ТОГДА СостоянияОСОрганизацийСрезПоследних.Период
		|		ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
		|	КОНЕЦ КАК ДатаПринятияКУчетуРегл,
		|	ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0) КАК ДатаПринятияКУчетуУпр,
		|	ЕСТЬNULL(МестонахождениеОСБухгалтерскийУчетСрезПоследних.МОЛ, ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)) КАК МОЛ,
		|	ЕСТЬNULL(МестонахождениеОСБухгалтерскийУчетСрезПоследних.Местонахождение, ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)) КАК Подразделение,
		|	ВЫБОР
		|		КОГДА НаличиеФайлов.ЕстьФайлы ЕСТЬ NULL ТОГДА 0
		|		КОГДА НаличиеФайлов.ЕстьФайлы ТОГДА 1
		|		ИНАЧЕ 0
		|	КОНЕЦ КАК ЕстьФайлы
		|ИЗ
		|	Справочник.ОбъектыЭксплуатации КАК СправочникОбъектыЭксплуатации
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.НаличиеФайлов КАК НаличиеФайлов
		|		ПО СправочникОбъектыЭксплуатации.Ссылка = НаличиеФайлов.ОбъектСФайлами
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПервоначальныеСведенияОСБухгалтерскийУчет.СрезПоследних КАК ПервоначальныеСведенияОСБухгалтерскийУчетСрезПоследних
		|		ПО СправочникОбъектыЭксплуатации.Ссылка = ПервоначальныеСведенияОСБухгалтерскийУчетСрезПоследних.ОсновноеСредство
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СостоянияОСОрганизаций.СрезПоследних(
		|				,
		|				НЕ &ОтборПоОрганизации
		|					ИЛИ Организация = &ОтборОрганизация) КАК СостоянияОСОрганизацийСрезПоследних
		|		ПО (ПервоначальныеСведенияОСБухгалтерскийУчетСрезПоследних.ОсновноеСредство = СостоянияОСОрганизацийСрезПоследних.ОсновноеСредство)
		|			И (ВЫБОР
		|				КОГДА &ОтборПоОрганизации
		|					ТОГДА ИСТИНА
		|				ИНАЧЕ ПервоначальныеСведенияОСБухгалтерскийУчетСрезПоследних.Организация = СостоянияОСОрганизацийСрезПоследних.Организация
		|			КОНЕЦ)
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.МестонахождениеОСБухгалтерскийУчет.СрезПоследних(
		|				,
		|				НЕ &ОтборПоОрганизации
		|					ИЛИ Организация = &ОтборОрганизация) КАК МестонахождениеОСБухгалтерскийУчетСрезПоследних
		|		ПО (ПервоначальныеСведенияОСБухгалтерскийУчетСрезПоследних.ОсновноеСредство = МестонахождениеОСБухгалтерскийУчетСрезПоследних.ОсновноеСредство)
		|			И (ВЫБОР
		|				КОГДА &ОтборПоОрганизации
		|					ТОГДА ИСТИНА
		|				ИНАЧЕ ПервоначальныеСведенияОСБухгалтерскийУчетСрезПоследних.Организация = МестонахождениеОСБухгалтерскийУчетСрезПоследних.Организация
		|			КОНЕЦ)
		|ГДЕ
		|	(НЕ &ОтборПоОрганизации
		|		ИЛИ ЕСТЬNULL(СостоянияОСОрганизацийСрезПоследних.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) = &ОтборОрганизация)";
					
	КонецЕсли;
	
	//-- Локализация

	Возврат ТекстЗапроса;
	
КонецФункции
 
#КонецОбласти

#Область Прочее

Функция ОбработкаПолученияФормы(ВидФормы, Параметры, ВыбраннаяФорма, ДополнительнаяИнформация, СтандартнаяОбработка) Экспорт
	
	//++ Локализация
	
	Если ВидФормы = "ФормаВыбора" 
		И ВнеоборотныеАктивыСлужебный.ДоступенВыборОбъектовЭксплуатации2_4(Параметры) Тогда
		
		// В концепции 2.4 своя форма выбора
		ВыбраннаяФорма = "ФормаВыбора2_4";
		СтандартнаяОбработка = Ложь;
		Возврат Истина;

	КонецЕсли;
	
	Если ВидФормы = "ФормаВыбора" Тогда
		
		ВыбраннаяФорма = "ФормаВыбора";
		
		Если Не Параметры.Свойство("Отбор") Тогда
			Параметры.Вставить("Отбор", Новый Структура);
		КонецЕсли;
		
		
		Если Параметры.Отбор.Свойство("ГруппаОС") Тогда
			Параметры.Отбор.Вставить("БУГруппаОС", Параметры.Отбор.ГруппаОС);
		ИначеЕсли Параметры.Свойство("БУГруппаОС") Тогда
			Параметры.Отбор.Вставить("ГруппаОС", Параметры.Отбор.БУГруппаОС);
		КонецЕсли;
		Если Параметры.Отбор.Свойство("АмортизационнаяГруппа") Тогда
			Параметры.Отбор.Вставить("БУАмортизационнаяГруппа", Параметры.Отбор.АмортизационнаяГруппа);
		ИначеЕсли Параметры.Свойство("БУАмортизационнаяГруппа") Тогда
			Параметры.Отбор.Вставить("АмортизационнаяГруппа", Параметры.Отбор.БУАмортизационнаяГруппа);
		КонецЕсли;
		
		Если Параметры.Свойство("ДоговорЛизинга") И ЗначениеЗаполнено(Параметры.ДоговорЛизинга) Тогда
			Параметры.Отбор.Вставить("НаправлениеДеятельности", ВнеоборотныеАктивыВызовСервера.НаправлениеДеятельности(Параметры.ДоговорЛизинга));
		КонецЕсли;
		
		Если Параметры.Свойство("ВариантПримененияЦелевогоФинансирования")
			И Параметры.ВариантПримененияЦелевогоФинансирования = ПредопределенноеЗначение("Перечисление.ВариантыПримененияЦелевогоФинансирования.НеИспользуется") Тогда
			Параметры.Отбор.Удалить("НаправлениеДеятельности");
		КонецЕсли;
		
	КонецЕсли;
	
	Возврат Истина;
	
	//-- Локализация
	
	Возврат Ложь;
	
КонецФункции

Функция ОписаниеЗапросаДляВыбора(Параметры, УстановитьВсеОтборы, МассивОбъектов) Экспорт

	ОписаниеЗапросаДляВыбора = Неопределено;
	
	//++ Локализация
	
	Если Параметры.Свойство("Контекст") Тогда
		ДоступныеКонтексты = Новый Структура(Параметры.Контекст);
	Иначе
		ДоступныеКонтексты = Новый Структура("БУ,УУ"); // По умолчанию доступны все контексты.
	КонецЕсли;
	
	ОтборСписка = ОбщегоНазначенияКлиентСервер.СвойствоСтруктуры(Параметры, "Отбор", Новый Структура);
	
	Если ОтборСписка.Свойство("ОтражатьВРеглУчете")
		И НЕ ОтборСписка.ОтражатьВРеглУчете
		И ДоступныеКонтексты.Свойство("БУ") Тогда
		ДоступныеКонтексты.Удалить("БУ"); // Доступен выбор отражения в учете и в регл. учете нет отражения.
	КонецЕсли; 
	
	Если ОтборСписка.Свойство("ОтражатьВУпрУчете")
		И НЕ ОтборСписка.ОтражатьВУпрУчете
		И ДоступныеКонтексты.Свойство("УУ") Тогда
		ДоступныеКонтексты.Удалить("УУ"); // Доступен выбор отражения в учете и в упр. учете нет отражения.
	КонецЕсли; 
	
	Если ОтборСписка.Свойство("АмортизационнаяГруппа") Тогда
		Если ЗначениеЗаполнено(ОтборСписка.АмортизационнаяГруппа) Тогда
			СписокВыбора = Новый Массив;
			СписокВыбора.Добавить(ОтборСписка.АмортизационнаяГруппа);
			СписокВыбора.Добавить(Перечисления.АмортизационныеГруппы.ПустаяСсылка());
			ОтборСписка.Вставить("АмортизационнаяГруппа", СписокВыбора);
		Иначе
			ОтборСписка.Удалить("АмортизационнаяГруппа");
		КонецЕсли; 
	КонецЕсли; 
	
	Если ОтборСписка.Свойство("ГруппаОС") Тогда
		Если ЗначениеЗаполнено(ОтборСписка.ГруппаОС) Тогда
			СписокВыбора = Новый Массив;
			СписокВыбора.Добавить(ОтборСписка.ГруппаОС);
			СписокВыбора.Добавить(Перечисления.ГруппыОС.ПустаяСсылка());
			ОтборСписка.Вставить("ГруппаОС", СписокВыбора);
		Иначе
			ОтборСписка.Удалить("ГруппаОС");
		КонецЕсли; 
	КонецЕсли; 
	
	Если Параметры.Свойство("ВариантПримененияЦелевогоФинансирования")
		И (Параметры.ВариантПримененияЦелевогоФинансирования = Перечисления.ВариантыПримененияЦелевогоФинансирования.НеИспользуется
			ИЛИ НЕ ЗначениеЗаполнено(Параметры.ВариантПримененияЦелевогоФинансирования)) Тогда
		ОтборСписка.Удалить("НаправлениеДеятельности");
	КонецЕсли;
	
	Если НЕ ПравоДоступа("Чтение", Метаданные.РегистрыСведений.МестонахождениеОС) Тогда
		ОтборСписка.Удалить("Подразделение");
		ОтборСписка.Удалить("Организация");
		ОтборСписка.Удалить("МОЛ");
	КонецЕсли;
	
	ДополнительныеПоля = "";
	ТекстОтборы = "";
	ПараметрыЗапроса = Новый Структура;
	ДоступныеПоля = Новый Массив;
	НеобходимыеТаблицы = Новый Структура;
	
	Если (ДоступныеКонтексты.Свойство("БУ") ИЛИ ДоступныеКонтексты.Свойство("УУ"))
		И ПравоДоступа("Чтение", Метаданные.РегистрыСведений.МестонахождениеОС) Тогда
		
		ПолеОрганизация = "ЕСТЬNULL(МестонахождениеОС.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка))";
		ПолеМОЛ = "ЕСТЬNULL(МестонахождениеОС.МОЛ, ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка))";
		ПолеПодразделение = "ЕСТЬNULL(МестонахождениеОС.Местонахождение, ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка))";
		ПолеАдресМестонахождения = "ЕСТЬNULL(МестонахождениеОС.АдресМестонахождения, """""""")";
		ПолеАрендатор = "ЕСТЬNULL(МестонахождениеОС.Арендатор, НЕОПРЕДЕЛЕНО)";
		
		НеобходимыеТаблицы.Вставить("МестонахождениеОС");
		
	Иначе
		
		ПолеОрганизация = "ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)";
		ПолеМОЛ = "ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)";
		ПолеПодразделение = "ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)";
		ПолеАдресМестонахождения = """""";
		ПолеАрендатор = "НЕОПРЕДЕЛЕНО";
		
	КонецЕсли;
	
	Если (ДоступныеКонтексты.Свойство("БУ") ИЛИ ДоступныеКонтексты.Свойство("УУ"))
		И ПравоДоступа("Чтение", Метаданные.РегистрыСведений.ПорядокУчетаОС) Тогда
		
		ПолеГФУ = "ЕСТЬNULL(ПорядокУчетаОС.ГруппаФинансовогоУчета, ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаВнеоборотныхАктивов.ПустаяСсылка))";
		
		НеобходимыеТаблицы.Вставить("ПорядокУчетаОС");
		
	Иначе
		
		ПолеГФУ = "ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаВнеоборотныхАктивов.ПустаяСсылка)";
		
	КонецЕсли;
	
	Если (ДоступныеКонтексты.Свойство("БУ") ИЛИ ДоступныеКонтексты.Свойство("УУ"))
		И ПравоДоступа("Чтение", Метаданные.РегистрыСведений.ПервоначальныеСведенияОС) Тогда
		
		ПолеАрендодатель = "ЕСТЬNULL(ПервоначальныеСведенияОС.Арендодатель, ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка))";
		
		НеобходимыеТаблицы.Вставить("ПервоначальныеСведенияОС");
		
	Иначе
		
		ПолеАрендодатель = "ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаВнеоборотныхАктивов.ПустаяСсылка)";
		
	КонецЕсли;
	
	Если (ДоступныеКонтексты.Свойство("БУ") ИЛИ ДоступныеКонтексты.Свойство("УУ"))
		И ПравоДоступа("Чтение", Метаданные.РегистрыСведений.ПервоначальныеСведенияОС)
		И ПравоДоступа("Чтение", Метаданные.РегистрыСведений.МестонахождениеОС) Тогда
		
		ПолеДатаПринятияКУчетуРегл = "ЕСТЬNULL(ПервоначальныеСведенияОС.ДатаВводаВЭксплуатациюБУ, ДАТАВРЕМЯ(1, 1, 1))";
		ПолеДатаПринятияКУчетуУпр = "ЕСТЬNULL(ПервоначальныеСведенияОС.ДатаВводаВЭксплуатациюУУ, ДАТАВРЕМЯ(1, 1, 1))";
		
		НеобходимыеТаблицы.Вставить("ПервоначальныеСведенияОС");
		
	Иначе
		ПолеДатаПринятияКУчетуРегл = "ДАТАВРЕМЯ(1, 1, 1)";
		ПолеДатаПринятияКУчетуУпр = "ДАТАВРЕМЯ(1, 1, 1)";
	КонецЕсли;
	
	ДополнительныеПоля = ДополнительныеПоля + "
		|,%1 КАК Организация
		|,%2 КАК МОЛ
		|,%3 КАК Подразделение
		|,%4 КАК АдресМестонахождения
		|,%5 КАК ГруппаФинансовогоУчета
		|,%6 КАК ДатаПринятияКУчетуРегл
		|,%7 КАК ДатаПринятияКУчетуУпр
		|,%8 КАК Арендатор
		|,%9 КАК Арендодатель";
	
	ДополнительныеПоля = СтрШаблон(
		ДополнительныеПоля, 
		ПолеОрганизация, 
		ПолеМОЛ, 
		ПолеПодразделение, 
		ПолеАдресМестонахождения, 
		ПолеГФУ,
		ПолеДатаПринятияКУчетуРегл,
		ПолеДатаПринятияКУчетуУпр,
		ПолеАрендатор,
		ПолеАрендодатель);
	
	Если ДоступныеКонтексты.Свойство("БУ") 
		И ПравоДоступа("Чтение", Метаданные.РегистрыСведений.ПорядокУчетаОСБУ) Тогда
		
		ДоступныеПоля.Добавить("СостояниеБУ");
		ДополнительныеПоля = ДополнительныеПоля + "
			|,ВЫБОР 
			|	КОГДА НЕ СправочникОбъектыЭксплуатации.ЭтоГруппа 
			|		ТОГДА ЕСТЬNULL(ПорядокУчетаОСБУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету))
			|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПустаяСсылка)
			|	КОНЕЦ КАК СостояниеБУ";
		
		НеобходимыеТаблицы.Вставить("ПорядокУчетаОСБУ");
		
	Иначе
		
		ДополнительныеПоля = ДополнительныеПоля + ",ВЫБОР 
			|	КОГДА НЕ СправочникОбъектыЭксплуатации.ЭтоГруппа 
			|		ТОГДА ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету)
			|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПустаяСсылка)
			|	КОНЕЦ КАК СостояниеБУ";
		
	КонецЕсли; 
	
	Если ДоступныеКонтексты.Свойство("УУ")
		И ПравоДоступа("Чтение", Метаданные.РегистрыСведений.ПорядокУчетаОСУУ) Тогда
		
		ДополнительныеПоля = ДополнительныеПоля + "
			|,ВЫБОР 
			|	КОГДА НЕ СправочникОбъектыЭксплуатации.ЭтоГруппа 
			|		ТОГДА ЕСТЬNULL(ПорядокУчетаОСУУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету))
			|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПустаяСсылка)
			|	КОНЕЦ КАК СостояниеУУ";
		
		НеобходимыеТаблицы.Вставить("ПорядокУчетаОСУУ");
		
	Иначе
		
		ДополнительныеПоля = ДополнительныеПоля + ",ВЫБОР 
			|	КОГДА НЕ СправочникОбъектыЭксплуатации.ЭтоГруппа 
			|		ТОГДА ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету)
			|		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПустаяСсылка)
			|	КОНЕЦ КАК СостояниеУУ";
		
	КонецЕсли;
	
	ДоступенВыборУчета = 
		(ОтборСписка.Свойство("ОтражатьВРеглУчете") ИЛИ ОтборСписка.Свойство("ОтражатьВУпрУчете"))
		И ВнеоборотныеАктивыСлужебный.ВедетсяРегламентированныйУчетВНА();
	
	Если ПравоДоступа("Чтение", Метаданные.РегистрыСведений.ПорядокУчетаОСУУ) 
		И ПравоДоступа("Чтение", Метаданные.РегистрыСведений.ПорядокУчетаОСБУ) Тогда
		
		Если ОтборСписка.Свойство("Состояние") Тогда
				
			Если ДоступныеКонтексты.Свойство("БУ") И ДоступныеКонтексты.Свойство("УУ") Тогда
				Если ДоступенВыборУчета Тогда
					ТекстОтборы = "
					|	ЕСТЬNULL(ПорядокУчетаОСБУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету)) В(&Состояние)
					|	И ЕСТЬNULL(ПорядокУчетаОСУУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету)) В(&Состояние)";
				Иначе
					ТекстОтборы = "
					|	(ЕСТЬNULL(ПорядокУчетаОСБУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету)) В(&Состояние)
					|		ИЛИ ЕСТЬNULL(ПорядокУчетаОСУУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету)) В(&Состояние))";
				КонецЕсли; 
			ИначеЕсли ДоступныеКонтексты.Свойство("БУ") Тогда
				ТекстОтборы = "
				|	ЕСТЬNULL(ПорядокУчетаОСБУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету)) В(&Состояние)";
			ИначеЕсли ДоступныеКонтексты.Свойство("УУ") Тогда
				ТекстОтборы = "
				|	ЕСТЬNULL(ПорядокУчетаОСУУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету)) В(&Состояние)";
			КонецЕсли;
			Если ТипЗнч(ОтборСписка.Состояние) = Тип("ФиксированныйМассив") Тогда
				ПараметрыЗапроса.Вставить("Состояние", Новый Массив(ОтборСписка.Состояние));
			Иначе
				ПараметрыЗапроса.Вставить("Состояние", ОтборСписка.Состояние);
			КонецЕсли;
			Параметры.Отбор.Удалить("Состояние");
			
		Иначе
			
			Если ДоступныеКонтексты.Свойство("БУ") И ДоступныеКонтексты.Свойство("УУ") Тогда
				ТекстОтборы = "
				|	(ЕСТЬNULL(ПорядокУчетаОСБУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету)) = &Состояние
				|		ИЛИ ЕСТЬNULL(ПорядокУчетаОСУУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету)) = &Состояние
				|		ИЛИ &Состояние = ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПустаяСсылка))";
			ИначеЕсли ДоступныеКонтексты.Свойство("БУ") Тогда
				ТекстОтборы = "
				|	(ЕСТЬNULL(ПорядокУчетаОСБУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету)) = &Состояние
				|		ИЛИ &Состояние = ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПустаяСсылка))";
			ИначеЕсли ДоступныеКонтексты.Свойство("УУ") Тогда
				ТекстОтборы = "
				|	(ЕСТЬNULL(ПорядокУчетаОСУУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету)) = &Состояние
				|		ИЛИ &Состояние = ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПустаяСсылка))";
			КонецЕсли;
			Если ТекстОтборы <> "" Тогда
				ПараметрыЗапроса.Вставить("Состояние", Перечисления.СостоянияОС.ПустаяСсылка());
			КонецЕсли;
			
		КонецЕсли;
		
	КонецЕсли; 
	
	Если Параметры.Свойство("ДвижимоеИмуществоПринятоеДо2013") Тогда
		
		НеобходимыеТаблицы.Вставить("ПервоначальныеСведенияОС");
		
		ТекстОтборы = ТекстОтборы 
						+ Символы.ПС 
						+ ?(ТекстОтборы <> "", "И ","")
						+ "ПервоначальныеСведенияОС.ДатаВводаВЭксплуатациюБУ < ДАТАВРЕМЯ(2013, 1, 1)
							|	И НЕ СправочникОбъектыЭксплуатации.НедвижимоеИмущество";
						
	ИначеЕсли Параметры.Свойство("ДвижимоеИмуществоПринятоеС2013") Тогда
		
		НеобходимыеТаблицы.Вставить("ПервоначальныеСведенияОС");
		
		ТекстОтборы = ТекстОтборы 
						+ Символы.ПС 
						+ ?(ТекстОтборы <> "", "И ","")
						+ "ПервоначальныеСведенияОС.ДатаВводаВЭксплуатациюБУ >= ДАТАВРЕМЯ(2013, 1, 1)
							|	И НЕ СправочникОбъектыЭксплуатации.НедвижимоеИмущество";
	КонецЕсли; 
	
	Если ОтборСписка.Свойство("ВидНалога") Тогда
		ТекстОтборы = ТекстОтборы 
			+ Символы.ПС 
			+ ?(ТекстОтборы <> "", "И ","")
			+ ВнеоборотныеАктивыЛокализация.УсловияОтбораПоВидуНалога("СправочникОбъектыЭксплуатации"); 
		ПараметрыЗапроса.Вставить("ВидНалога", ОтборСписка.ВидНалога);
	КонецЕсли; 
	
	Если УстановитьВсеОтборы Тогда
		
		Для каждого КлючИЗначение Из ОтборСписка Цикл
			
			Если НЕ ЗначениеЗаполнено(КлючИЗначение.Значение) Тогда
				Продолжить;
			КонецЕсли;
			
			Если КлючИЗначение.Ключ = "Организация" Тогда
				ПутьКПолю = ПолеОрганизация;
			ИначеЕсли КлючИЗначение.Ключ = "Подразделение" Тогда
				ПутьКПолю = ПолеПодразделение;
			ИначеЕсли КлючИЗначение.Ключ = "МОЛ" Тогда
				ПутьКПолю = ПолеМОЛ;
			ИначеЕсли КлючИЗначение.Ключ = "Арендатор" Тогда
				ПутьКПолю = ПолеАрендатор;
			ИначеЕсли КлючИЗначение.Ключ = "Арендодатель" Тогда
				ПутьКПолю = ПолеАрендодатель;
			ИначеЕсли КлючИЗначение.Ключ = "АмортизационнаяГруппа"
				ИЛИ КлючИЗначение.Ключ = "ГруппаОС"
				ИЛИ КлючИЗначение.Ключ = "НаправлениеДеятельности"
				ИЛИ КлючИЗначение.Ключ = "Статус" Тогда
				
				ПутьКПолю = "СправочникОбъектыЭксплуатации." + КлючИЗначение.Ключ;
			Иначе
				Продолжить;
			КонецЕсли;
			
			ЭтоМассив = ТипЗнч(КлючИЗначение.Значение) = Тип("ФиксированныйМассив") 
						ИЛИ ТипЗнч(КлючИЗначение.Значение) = Тип("Массив");
						
			ТекстОтборы = ТекстОтборы 
							+ Символы.ПС 
							+ ?(ТекстОтборы <> "", "И ","")
							+ ПутьКПолю 
							+ ?(ЭтоМассив, " В (&" + КлючИЗначение.Ключ + ")", " = &" + КлючИЗначение.Ключ);
							
			ПараметрыЗапроса.Вставить(КлючИЗначение.Ключ, КлючИЗначение.Значение);
		КонецЦикла; 
		
	КонецЕсли; 
	
	ТекстСоединения = "";
	
	Если НеобходимыеТаблицы.Свойство("МестонахождениеОС")
		ИЛИ НеобходимыеТаблицы.Свойство("ПервоначальныеСведенияОС")
		ИЛИ НеобходимыеТаблицы.Свойство("ПорядокУчетаОСУУ")
		ИЛИ НеобходимыеТаблицы.Свойство("ПорядокУчетаОСБУ") Тогда
		ТекстСоединения = ТекстСоединения + "
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.МестонахождениеОС.СрезПоследних(//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ_ДАТА//,//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ//) КАК МестонахождениеОС
		|		ПО СправочникОбъектыЭксплуатации.Ссылка = МестонахождениеОС.ОсновноеСредство";
	КонецЕсли;
	
	Если НеобходимыеТаблицы.Свойство("ПорядокУчетаОС") Тогда
		ТекстСоединения = ТекстСоединения + "
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокУчетаОС.СрезПоследних(//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ_ДАТА//,//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ//) КАК ПорядокУчетаОС
		|		ПО СправочникОбъектыЭксплуатации.Ссылка = ПорядокУчетаОС.ОсновноеСредство";
	КонецЕсли;
	
	Если НеобходимыеТаблицы.Свойство("ПервоначальныеСведенияОС") Тогда
		ТекстСоединения = ТекстСоединения + "
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПервоначальныеСведенияОС.СрезПоследних(//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ_ДАТА//,//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ//) КАК ПервоначальныеСведенияОС
		|		ПО ПервоначальныеСведенияОС.Организация = МестонахождениеОС.Организация
		|			И ПервоначальныеСведенияОС.ОсновноеСредство = МестонахождениеОС.ОсновноеСредство";
	КонецЕсли;
	
	Если НеобходимыеТаблицы.Свойство("ПорядокУчетаОСБУ") Тогда
		ТекстСоединения = ТекстСоединения + "
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокУчетаОСБУ.СрезПоследних(//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ_ДАТА//,//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ//) КАК ПорядокУчетаОСБУ
		|		ПО СправочникОбъектыЭксплуатации.Ссылка = ПорядокУчетаОСБУ.ОсновноеСредство
		|			И ПорядокУчетаОСБУ.Организация = МестонахождениеОС.Организация";
	КонецЕсли;
	
	Если НеобходимыеТаблицы.Свойство("ПорядокУчетаОСУУ") Тогда
		ТекстСоединения = ТекстСоединения + "
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокУчетаОСУУ.СрезПоследних(//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ_ДАТА//,//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ//) КАК ПорядокУчетаОСУУ
		|		ПО СправочникОбъектыЭксплуатации.Ссылка = ПорядокУчетаОСУУ.ОсновноеСредство
		|			И ПорядокУчетаОСУУ.Организация = МестонахождениеОС.Организация";
	КонецЕсли;
	
	ПараметрыСрезаПоследнихДата = "";
	ПараметрыСрезаПоследних = "";
	Если Параметры.Свойство("ДатаСведений") Тогда
		ПараметрыСрезаПоследнихДата = "&ДатаСведений";
		ПараметрыЗапроса.Вставить("ДатаСведений", КонецДня(Параметры.ДатаСведений));
	КонецЕсли; 
	Если Параметры.Свойство("ТекущийРегистратор") Тогда
		ПараметрыСрезаПоследних = "Регистратор <> &ТекущийРегистратор";
		ПараметрыЗапроса.Вставить("ТекущийРегистратор", Параметры.ТекущийРегистратор);
	КонецЕсли; 
	ТекстСоединения = СтрЗаменить(ТекстСоединения, "//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ_ДАТА//", ПараметрыСрезаПоследнихДата);
	ТекстСоединения = СтрЗаменить(ТекстСоединения, "//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ//", ПараметрыСрезаПоследних);
	
	ТекстПервые = "";
	Если Параметры.Свойство("СтрокаПоиска") Тогда
		ТекстОтборы = ТекстОтборы + "
		|" + ?(ТекстОтборы <> "", "И ","")
		+ "СправочникОбъектыЭксплуатации.Наименование ПОДОБНО &СтрокаПоиска
			|	И НЕ СправочникОбъектыЭксплуатации.ЭтоГруппа
			|	И НЕ СправочникОбъектыЭксплуатации.ПометкаУдаления";
		ТекстПервые = "РАЗРЕШЕННЫЕ ПЕРВЫЕ 10";
		ПараметрыЗапроса.Вставить("СтрокаПоиска", "%" + Параметры.СтрокаПоиска + "%");
	КонецЕсли;
	
	Если МассивОбъектов <> Неопределено Тогда
		ТекстОтборы = ТекстОтборы + "
		|" + ?(ТекстОтборы <> "", "И ","")
		+ "СправочникОбъектыЭксплуатации.Ссылка В(&МассивОбъектов)
			|	И НЕ СправочникОбъектыЭксплуатации.ЭтоГруппа
			|	И НЕ СправочникОбъектыЭксплуатации.ПометкаУдаления";
		ПараметрыЗапроса.Вставить("МассивОбъектов", МассивОбъектов);
	КонецЕсли; 
	
	ТекстРегистрация = "";
	Если Параметры.Свойство("ЕстьРегистрацияТранспортныхСредств") Тогда
		ТекстРегистрация = ТекстРегистрация + "
		|" + ?(ТекстРегистрация <> "", "И ","")
		+ "СправочникОбъектыЭксплуатации.Ссылка В (
		|	ВЫБРАТЬ 
		|		ДанныеРегистра.ОсновноеСредство 
		|	ИЗ 
		|		РегистрСведений.РегистрацияТранспортныхСредств.СрезПоследних(//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ_ДАТА//,//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ//) КАК ДанныеРегистра
		|	ГДЕ
		|		ДанныеРегистра.ВидЗаписи = ЗНАЧЕНИЕ(Перечисление.ВидЗаписиОРегистрации.Регистрация))";
	КонецЕсли; 
	
	Если Параметры.Свойство("ЕстьРегистрацияЗемельныхУчастков") Тогда
		ТекстРегистрация = ТекстРегистрация + "
		|" + ?(ТекстРегистрация <> "", "И ","")
		+ "СправочникОбъектыЭксплуатации.Ссылка В (
		|	ВЫБРАТЬ 
		|		ДанныеРегистра.ОсновноеСредство 
		|	ИЗ 
		|		РегистрСведений.РегистрацияЗемельныхУчастков.СрезПоследних(//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ_ДАТА//,//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ//) КАК ДанныеРегистра
		|	ГДЕ
		|		ДанныеРегистра.ВидЗаписи = ЗНАЧЕНИЕ(Перечисление.ВидЗаписиОРегистрации.Регистрация))";
	КонецЕсли; 
	
	Если ТекстРегистрация <> "" Тогда
		
		ПараметрыСрезаПоследних_Регистрация = ПараметрыСрезаПоследних;
		Если Параметры.Свойство("Организация") И ЗначениеЗаполнено(Параметры.Организация) Тогда
			ПараметрыСрезаПоследних_Регистрация = 
				ПараметрыСрезаПоследних_Регистрация 
				+ ?(ПараметрыСрезаПоследних_Регистрация <> "", " И ", "")
				+ "Организация = &Организация";
			ПараметрыЗапроса.Вставить("Организация", Параметры.Организация);
		КонецЕсли; 
		
		ТекстРегистрация = СтрЗаменить(ТекстРегистрация, "//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ_ДАТА//", ПараметрыСрезаПоследнихДата);
		ТекстРегистрация = СтрЗаменить(ТекстРегистрация, "//ПАРАМЕТРЫ_СРЕЗАПОСЛЕДНИХ//", ПараметрыСрезаПоследних_Регистрация);
		
		ТекстОтборы = ТекстОтборы + "
		|" + ?(ТекстОтборы <> "", "И ","") + ТекстРегистрация;
		
	КонецЕсли;
	
	Если ТекстОтборы <> "" Тогда
		ТекстОтборы = "
		|ГДЕ
		|" + ТекстОтборы;
	КонецЕсли;
	
	ТекстЗапроса =
	"ВЫБРАТЬ //ПЕРВЫЕ//
	|	СправочникОбъектыЭксплуатации.Ссылка,
	|	СправочникОбъектыЭксплуатации.ПометкаУдаления,
	|	СправочникОбъектыЭксплуатации.Родитель,
	|	СправочникОбъектыЭксплуатации.ЭтоГруппа,
	|	СправочникОбъектыЭксплуатации.Код,
	|	СправочникОбъектыЭксплуатации.Наименование,
	|	СправочникОбъектыЭксплуатации.ИнвентарныйНомер,
	|	СправочникОбъектыЭксплуатации.ГруппаОС,
	|	СправочникОбъектыЭксплуатации.ГруппаОСМеждународныйУчет,
	|	СправочникОбъектыЭксплуатации.КодПоОКОФ,
	|	СправочникОбъектыЭксплуатации.ШифрПоЕНАОФ,
	|	СправочникОбъектыЭксплуатации.ДатаВыпуска,
	|	СправочникОбъектыЭксплуатации.ЗаводскойНомер,
	|	СправочникОбъектыЭксплуатации.Изготовитель,
	|	СправочникОбъектыЭксплуатации.Класс,
	|	СправочникОбъектыЭксплуатации.Модель,
	|	СправочникОбъектыЭксплуатации.НаименованиеПолное,
	|	СправочникОбъектыЭксплуатации.НомерПаспорта,
	|	СправочникОбъектыЭксплуатации.ОбъектБытовогоНазначения,
	|	СправочникОбъектыЭксплуатации.Подкласс,
	|	СправочникОбъектыЭксплуатации.Расположение,
	|	СправочникОбъектыЭксплуатации.РемонтирующееПодразделение,
	|	СправочникОбъектыЭксплуатации.СерийныйНомер,
	|	СправочникОбъектыЭксплуатации.Статус,
	|	СправочникОбъектыЭксплуатации.НаправлениеДеятельности,
	|	СправочникОбъектыЭксплуатации.АмортизационнаяГруппа,
	|	СправочникОбъектыЭксплуатации.НедвижимоеИмущество,
	|	СправочникОбъектыЭксплуатации.Комментарий
	|	//ДОПОЛНИТЕЛЬНЫЕ_ПОЛЯ//
	|ИЗ
	|	Справочник.ОбъектыЭксплуатации КАК СправочникОбъектыЭксплуатации
	|	//СОЕДИНЕНИЯ//
	|	//ОТБОРЫ//";
	
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "//ДОПОЛНИТЕЛЬНЫЕ_ПОЛЯ//", ДополнительныеПоля);
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "//СОЕДИНЕНИЯ//", ТекстСоединения);
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "//ОТБОРЫ//", ТекстОтборы);
	ТекстЗапроса = СтрЗаменить(ТекстЗапроса, "//ПЕРВЫЕ//", ТекстПервые);

	ОписаниеЗапросаДляВыбора = Новый Структура("ТекстЗапроса,ПараметрыЗапроса,ДоступныеПоля", ТекстЗапроса, ПараметрыЗапроса, ДоступныеПоля);
	
	//-- Локализация
	
	Возврат ОписаниеЗапросаДляВыбора;
	
КонецФункции

Функция ЕстьПраваНаЧтениеСведений() Экспорт

	//++ Локализация
	
	Если НЕ ПравоДоступа("Чтение", Метаданные.РегистрыСведений.ПорядокУчетаОСБУ) Тогда
		Возврат Ложь;
	КонецЕсли;

	//-- Локализация
	
	Возврат Истина;
	
КонецФункции

Функция ТекстЗапросаПоказательНаработки() Экспорт

	ТекстЗапроса = Неопределено;
	
	//++ Локализация
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	ПервоначальныеСведенияОС.ПоказательНаработки КАК ПоказательНаработки
	|ИЗ
	|	РегистрСведений.ПервоначальныеСведенияОСБухгалтерскийУчет.СрезПоследних(&Дата, ОсновноеСредство = &Объект) КАК ПервоначальныеСведенияОС
	|ГДЕ
	|	НЕ &ИспользуетсяУправлениеВНА_2_4
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ПорядокУчетаОС.ПоказательНаработки
	|ИЗ
	|	РегистрСведений.ПорядокУчетаОС.СрезПоследних(&Дата, ОсновноеСредство = &Объект) КАК ПорядокУчетаОС
	|ГДЕ
	|	НЕ &ИспользуетсяУправлениеВНА_2_4";
	
	//-- Локализация
	
	Возврат ТекстЗапроса;
	
КонецФункции

Функция ПервоначальныеСведения(ОсновноеСредство, Период) Экспорт

	ПервоначальныеСведения = Неопределено;
	
	//++ Локализация
	
	ПервоначальныеСведения = Новый Структура;
	ПервоначальныеСведения.Вставить("Организация", Неопределено);
	ПервоначальныеСведения.Вставить("Местонахождение", Неопределено);
	ПервоначальныеСведения.Вставить("МОЛ", Неопределено);
	ПервоначальныеСведения.Вставить("ДатаВводаВЭксплуатациюБУ", '000101010000');
	ПервоначальныеСведения.Вставить("ДатаВводаВЭксплуатациюУУ", '000101010000');
	ПервоначальныеСведения.Вставить("ДокументВводаВЭксплуатациюБУ", Неопределено);
	ПервоначальныеСведения.Вставить("ДокументВводаВЭксплуатациюУУ", Неопределено);
	ПервоначальныеСведения.Вставить("СостояниеУУ", Перечисления.СостоянияОС.НеПринятоКУчету);
	ПервоначальныеСведения.Вставить("СостояниеБУ", Перечисления.СостоянияОС.НеПринятоКУчету);
	
	Если НЕ ПравоДоступа("Чтение", Метаданные.РегистрыСведений.МестонахождениеОС)
		ИЛИ НЕ ПравоДоступа("Чтение", Метаданные.РегистрыСведений.ПервоначальныеСведенияОС)
		ИЛИ НЕ ПравоДоступа("Чтение", Метаданные.РегистрыСведений.ПорядокУчетаОСУУ)
		ИЛИ НЕ ПравоДоступа("Чтение", Метаданные.РегистрыСведений.ПорядокУчетаОСБУ) Тогда
		
		Возврат ПервоначальныеСведения;
	КонецЕсли; 
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	МестонахождениеОС.Организация,
	|	МестонахождениеОС.Местонахождение,
	|	МестонахождениеОС.МОЛ,
	|	ПервоначальныеСведенияОС.ДатаВводаВЭксплуатациюБУ,
	|	ПервоначальныеСведенияОС.ДатаВводаВЭксплуатациюУУ,
	|	ПервоначальныеСведенияОС.ДокументВводаВЭксплуатациюБУ,
	|	ПервоначальныеСведенияОС.ДокументВводаВЭксплуатациюУУ,
	|	ПервоначальныеСведенияОС.ДоговорЛизинга,
	|	ЕСТЬNULL(ПорядокУчетаОСУУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету)) КАК СостояниеУУ,
	|	ЕСТЬNULL(ПорядокУчетаОСБУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету)) КАК СостояниеБУ
	|ИЗ
	|	РегистрСведений.МестонахождениеОС.СрезПоследних(&Период, ОсновноеСредство = &Ссылка) КАК МестонахождениеОС
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПервоначальныеСведенияОС.СрезПоследних(&Период, ОсновноеСредство = &Ссылка) КАК ПервоначальныеСведенияОС
	|		ПО МестонахождениеОС.ОсновноеСредство = ПервоначальныеСведенияОС.ОсновноеСредство
	|			И МестонахождениеОС.Организация = ПервоначальныеСведенияОС.Организация
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокУчетаОСУУ.СрезПоследних(&Период, ОсновноеСредство = &Ссылка) КАК ПорядокУчетаОСУУ
	|		ПО МестонахождениеОС.ОсновноеСредство = ПорядокУчетаОСУУ.ОсновноеСредство
	|			И МестонахождениеОС.Организация = ПорядокУчетаОСУУ.Организация
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокУчетаОСБУ.СрезПоследних(&Период, ОсновноеСредство = &Ссылка) КАК ПорядокУчетаОСБУ
	|		ПО МестонахождениеОС.ОсновноеСредство = ПорядокУчетаОСБУ.ОсновноеСредство
	|			И МестонахождениеОС.Организация = ПорядокУчетаОСБУ.Организация";
	
	Запрос = Новый Запрос(ТекстЗапроса);
	Запрос.УстановитьПараметр("Ссылка", ОсновноеСредство);
	Запрос.УстановитьПараметр("Период", Период);
	Результат = Запрос.Выполнить();
	Если Результат.Пустой() Тогда
		Возврат ПервоначальныеСведения;
	КонецЕсли;
	
	Выборка = Результат.Выбрать();
	Выборка.Следующий();
	
	ЗаполнитьЗначенияСвойств(ПервоначальныеСведения, Выборка);
	
	//-- Локализация
	
	Возврат ПервоначальныеСведения;
	
КонецФункции

Функция СведенияОбУчете(ОсновноеСредство, ОтборОрганизация) Экспорт

	СведенияОбУчете = Неопределено;
	
	//++ Локализация
	
	Если НЕ ПравоДоступа("Чтение", Метаданные.РегистрыСведений.МестонахождениеОС)
		ИЛИ НЕ ПравоДоступа("Чтение", Метаданные.РегистрыСведений.ПервоначальныеСведенияОС)
		ИЛИ НЕ ПравоДоступа("Чтение", Метаданные.РегистрыСведений.ПорядокУчетаОС)
		ИЛИ НЕ ПравоДоступа("Чтение", Метаданные.РегистрыСведений.ПорядокУчетаОСУУ)
		ИЛИ НЕ ПравоДоступа("Чтение", Метаданные.РегистрыСведений.ПорядокУчетаОСБУ)
		ИЛИ НЕ ПравоДоступа("Чтение", Метаданные.РегистрыСведений.ПараметрыАмортизацииОСБУ)
		ИЛИ НЕ ПравоДоступа("Чтение", Метаданные.РегистрыСведений.ПараметрыАмортизацииОСУУ) Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	ТекстЗапроса = 
	"ВЫБРАТЬ
	|	ЕСТЬNULL(ПервоначальныеСведенияОС.ДатаВводаВЭксплуатациюБУ, ДАТАВРЕМЯ(1, 1, 1)) КАК ДатаВводаВЭксплуатациюБУ,
	|	ЕСТЬNULL(ПервоначальныеСведенияОС.ДатаВводаВЭксплуатациюУУ, ДАТАВРЕМЯ(1, 1, 1)) КАК ДатаВводаВЭксплуатациюУУ,
	|	ЕСТЬNULL(ПервоначальныеСведенияОС.ДокументВводаВЭксплуатациюБУ, НЕОПРЕДЕЛЕНО) КАК ДокументВводаВЭксплуатациюБУ,
	|	ЕСТЬNULL(ПервоначальныеСведенияОС.ДокументВводаВЭксплуатациюУУ, НЕОПРЕДЕЛЕНО) КАК ДокументВводаВЭксплуатациюУУ,
	|	ЕСТЬNULL(ПервоначальныеСведенияОС.ДокументСнятияСУчета, НЕОПРЕДЕЛЕНО) КАК ДокументСнятияСУчета,
	|	ЕСТЬNULL(ПервоначальныеСведенияОС.ДокументСнятияСУчета.Дата, ДАТАВРЕМЯ(1, 1, 1)) КАК ДатаСнятияСУчета,
	|	ЕСТЬNULL(ПорядокУчетаОССрезПоследних.ГруппаФинансовогоУчета, НЕОПРЕДЕЛЕНО) КАК ГруппаФинансовогоУчета,
	|	ЕСТЬNULL(ПорядокУчетаОССрезПоследних.ГруппаФинансовогоУчета.Представление, """") КАК ГруппаФинансовогоУчетаПредставление,
	|
	|	ВЫБОР 
	|		КОГДА &ОтборПоОрганизации 
	|				И МестонахождениеОС.Арендатор = &ОтборОрганизация
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК ПолученоВАрендуОтДругойОрганизации,
	|
	|	ВЫБОР 
	|		КОГДА &ОтборПоОрганизации 
	|				И МестонахождениеОС.Арендатор = &ОтборОрганизация
	|				И НЕ ПорядокУчетаОСБУ.Состояние ЕСТЬ NULL
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПринятоКЗабалансовомуУчету)
	|		ИНАЧЕ ЕСТЬNULL(ПорядокУчетаОСБУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету))
	|	КОНЕЦ КАК СостояниеБУ,
	|
	|	ВЫБОР 
	|		КОГДА &ОтборПоОрганизации 
	|				И МестонахождениеОС.Арендатор = &ОтборОрганизация
	|				И НЕ ПорядокУчетаОСУУ.Состояние ЕСТЬ NULL
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПринятоКЗабалансовомуУчету)
	|		ИНАЧЕ ЕСТЬNULL(ПорядокУчетаОСУУ.Состояние, ЗНАЧЕНИЕ(Перечисление.СостоянияОС.НеПринятоКУчету))
	|	КОНЕЦ КАК СостояниеУУ,
	|
	|	ЕСТЬNULL(ПараметрыАмортизацииОСУУСрезПоследних.СрокИспользования, 0) КАК СрокИспользованияУУ,
	|	ЕСТЬNULL(ПараметрыАмортизацииОСУУСрезПоследних.ЛиквидационнаяСтоимость, 0) КАК ЛиквидационнаяСтоимость,
	|
	|	ЕСТЬNULL(ПараметрыАмортизацииОСБУСрезПоследних.СрокПолезногоИспользованияБУ, 0) КАК СрокИспользованияБУ,
	|	ЕСТЬNULL(ПараметрыАмортизацииОСБУСрезПоследних.СрокПолезногоИспользованияНУ, 0) КАК СрокИспользованияНУ,
	|	МестонахождениеОС.Период КАК ПериодСведенийОМестонахождении,
	|
	|	ВЫБОР
	|		КОГДА &ОтборПоОрганизации И МестонахождениеОС.Арендатор = &ОтборОрганизация
	|			ТОГДА МестонахождениеОС.Арендатор
	|		ИНАЧЕ ЕСТЬNULL(МестонахождениеОС.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) 
	|	КОНЕЦ КАК Организация,
	|
	|	ВЫБОР
	|		КОГДА &ОтборПоОрганизации И МестонахождениеОС.Арендатор = &ОтборОрганизация
	|			ТОГДА ЕСТЬNULL(ВЫРАЗИТЬ(МестонахождениеОС.Арендатор КАК Справочник.Организации).Представление, """")
	|		ИНАЧЕ ЕСТЬNULL(МестонахождениеОС.Организация.Представление, """")
	|	КОНЕЦ КАК ОрганизацияПредставление,
	|
	|	ВЫБОР
	|		КОГДА &ОтборПоОрганизации И МестонахождениеОС.Арендатор = &ОтборОрганизация
	|			ТОГДА МестонахождениеОС.МОЛАрендатора
	|		ИНАЧЕ МестонахождениеОС.МОЛ
	|	КОНЕЦ КАК МОЛ,
	|
	|	ВЫБОР
	|		КОГДА &ОтборПоОрганизации И МестонахождениеОС.Арендатор = &ОтборОрганизация
	|			ТОГДА ЕСТЬNULL(МестонахождениеОС.МОЛАрендатора.Представление, """")
	|		ИНАЧЕ ЕСТЬNULL(МестонахождениеОС.МОЛ.Представление, """")
	|	КОНЕЦ КАК МОЛПредставление,
	|
	|	ВЫБОР
	|		КОГДА &ОтборПоОрганизации И МестонахождениеОС.Арендатор = &ОтборОрганизация
	|			ТОГДА МестонахождениеОС.ПодразделениеАрендатора
	|		ИНАЧЕ МестонахождениеОС.Местонахождение
	|	КОНЕЦ КАК Подразделение,
	|
	|	ВЫБОР
	|		КОГДА &ОтборПоОрганизации И МестонахождениеОС.Арендатор = &ОтборОрганизация
	|			ТОГДА ЕСТЬNULL(МестонахождениеОС.ПодразделениеАрендатора.Представление, """")
	|		ИНАЧЕ ЕСТЬNULL(МестонахождениеОС.Местонахождение.Представление, """")
	|	КОНЕЦ КАК ПодразделениеПредставление,
	|
	|	МестонахождениеОС.АдресМестонахождения КАК АдресМестонахождения
	|ИЗ
	|	РегистрСведений.МестонахождениеОС.СрезПоследних(, ОсновноеСредство = &Ссылка) КАК МестонахождениеОС
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПервоначальныеСведенияОС.СрезПоследних(, ОсновноеСредство = &Ссылка) КАК ПервоначальныеСведенияОС
	|		ПО (ПервоначальныеСведенияОС.ОсновноеСредство = МестонахождениеОС.ОсновноеСредство)
	|			И (ПервоначальныеСведенияОС.Организация = МестонахождениеОС.Организация)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокУчетаОС.СрезПоследних(, ОсновноеСредство = &Ссылка) КАК ПорядокУчетаОССрезПоследних
	|		ПО (ПорядокУчетаОССрезПоследних.ОсновноеСредство = МестонахождениеОС.ОсновноеСредство)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокУчетаОСУУ.СрезПоследних(, ОсновноеСредство = &Ссылка) КАК ПорядокУчетаОСУУ
	|		ПО (ПорядокУчетаОСУУ.ОсновноеСредство = МестонахождениеОС.ОсновноеСредство)
	|			И (ПорядокУчетаОСУУ.Организация = МестонахождениеОС.Организация)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПорядокУчетаОСБУ.СрезПоследних(, ОсновноеСредство = &Ссылка) КАК ПорядокУчетаОСБУ
	|		ПО (ПорядокУчетаОСБУ.ОсновноеСредство = МестонахождениеОС.ОсновноеСредство)
	|			И (ПорядокУчетаОСБУ.Организация = МестонахождениеОС.Организация)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПараметрыАмортизацииОСБУ.СрезПоследних(, ОсновноеСредство = &Ссылка) КАК ПараметрыАмортизацииОСБУСрезПоследних
	|		ПО (ПараметрыАмортизацииОСБУСрезПоследних.ОсновноеСредство = МестонахождениеОС.ОсновноеСредство)
	|			И (ПараметрыАмортизацииОСБУСрезПоследних.Организация = МестонахождениеОС.Организация)
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПараметрыАмортизацииОСУУ.СрезПоследних(, ОсновноеСредство = &Ссылка) КАК ПараметрыАмортизацииОСУУСрезПоследних
	|		ПО (ПараметрыАмортизацииОСУУСрезПоследних.ОсновноеСредство = МестонахождениеОС.ОсновноеСредство)
	|			И (ПараметрыАмортизацииОСУУСрезПоследних.Организация = МестонахождениеОС.Организация)";

	
	Запрос = Новый Запрос(ТекстЗапроса);
	Запрос.УстановитьПараметр("Ссылка", ОсновноеСредство);
	Запрос.УстановитьПараметр("ОтборОрганизация", ОтборОрганизация);
	Запрос.УстановитьПараметр("ОтборПоОрганизации", ЗначениеЗаполнено(ОтборОрганизация));
	Результат = Запрос.Выполнить();
	
	Если Результат.Пустой() Тогда
		Возврат Неопределено;
	КонецЕсли;
	
	СведенияОбУчете = Новый Структура;
	Для каждого КолонкаЗапроса Из Результат.Колонки Цикл
		СведенияОбУчете.Вставить(КолонкаЗапроса.Имя);
	КонецЦикла; 
	
	Выборка = Результат.Выбрать();
	Выборка.Следующий();
	ЗаполнитьЗначенияСвойств(СведенияОбУчете, Выборка);
	
	//-- Локализация
	
	Возврат СведенияОбУчете;

КонецФункции

Функция ТекстЗапросаДоступныхДляВыбораОбъектов() Экспорт

	ТекстЗапроса = Неопределено;
	
	//++ Локализация
	
	Если ВнеоборотныеАктивы.ИспользуетсяУправлениеВНА_2_4() Тогда
		
		ТекстЗапроса =
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	СрезСведенияОС.ОсновноеСредство КАК Ссылка
		|ИЗ
		|	РегистрСведений.ПараметрыАмортизацииОСУУ.СрезПоследних(, &РегистрацияНаработки) КАК СрезСведенияОС
		|ГДЕ
		|	СрезСведенияОС.МетодНачисленияАмортизации = ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииОС.ПропорциональноОбъемуПродукции)
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ПервоначальныеСведенияОС.ОсновноеСредство
		|ИЗ
		|	РегистрСведений.ПервоначальныеСведенияОС.СрезПоследних(
		|			,
		|			&РегистрацияНаработки
		|				И МетодНачисленияАмортизацииБУ В (
		|					ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииОС.ПропорциональноОбъемуПродукции), 
		|					ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииОС.ПоЕНАОФНа1000кмПробега))) КАК ПервоначальныеСведенияОС";
		
	Иначе
		
		ТекстЗапроса =
		"ВЫБРАТЬ РАЗРЕШЕННЫЕ
		|	СрезСведенияОС.ОсновноеСредство КАК Ссылка
		|ИЗ
		|	РегистрСведений.ПервоначальныеСведенияОСБухгалтерскийУчет.СрезПоследних(
		|			,
		|			&РегистрацияНаработки
		|				И СпособНачисленияАмортизации В (
		|					ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииОС.ПропорциональноОбъемуПродукции), 
		|					ЗНАЧЕНИЕ(Перечисление.СпособыНачисленияАмортизацииОС.ПоЕНАОФНа1000кмПробега))) КАК СрезСведенияОС";
		
	КонецЕсли; 
	
	//-- Локализация
	
	Возврат ТекстЗапроса;
	
КонецФункции

Функция МожноПринятьКУчету(СведенияОбУчете) Экспорт

	МожноПринятьКУчету = СведенияОбУчете.СостояниеБУ <> Перечисления.СостоянияОС.СнятоСУчета;
	
	//++ Локализация
	МожноПринятьКУчету = СведенияОбУчете.ДокументВводаВЭксплуатациюБУ <> Тип("ДокументСсылка.ПоступлениеАрендованныхОС")
							И МожноПринятьКУчету;
	//-- Локализация
	
	Возврат МожноПринятьКУчету;
	
КонецФункции
 
#КонецОбласти

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

#Область Печать

//++ Локализация

Функция ПечатьОС6_2003(МассивОбъектов, ОбъектыПечати, ПараметрыПечати)
	
	УстановитьПривилегированныйРежим(Истина);
	
	ТабДок = Новый ТабличныйДокумент;
	ТабДок.АвтоМасштаб = Истина;
	ТабДок.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
	ТабДок.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_ОсновныеСредства_ОС6";
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Справочник.ОбъектыЭксплуатации.ПФ_MXL_ОС6");
	
	Шапка = Макет.ПолучитьОбласть("Шапка");
	ШапкаРазделов1и2 = Макет.ПолучитьОбласть("ШапкаРазделов1и2");
	ШапкаРаздела3 = Макет.ПолучитьОбласть("ШапкаРаздела3");
	СтрокиРаздела3 = Макет.ПолучитьОбласть("СтрокиРаздела3");
	ШапкаРаздела4 = Макет.ПолучитьОбласть("ШапкаРаздела4");
	СтрокаРаздела4 = Макет.ПолучитьОбласть("СтрокаРаздела4");
	ПодвалСтраницы1 = Макет.ПолучитьОбласть("ПодвалСтраницы1");
	ШапкаРазделов5и6 = Макет.ПолучитьОбласть("ШапкаРазделов5и6");
	СтрокаРазделов5и6 = Макет.ПолучитьОбласть("СтрокаРазделов5и6");
	ШапкаРаздела7_1 = Макет.ПолучитьОбласть("ШапкаРаздела7_1");
	СтрокиРаздела7_1 = Макет.ПолучитьОбласть("СтрокиРаздела7_1");
	ШапкаРаздела7_2 = Макет.ПолучитьОбласть("ШапкаРаздела7_2");
	ПодвалСтраницы2 = Макет.ПолучитьОбласть("ПодвалСтраницы2");
	
	Если ПараметрыПечати.Свойство("ДатаСведений") Тогда
		ДатаСведений = ПараметрыПечати.ДатаСведений;
	Иначе
		ДатаСведений = ТекущаяДатаСеанса();
	КонецЕсли;
	
	ДанныеПечатнойФормы = ДанныеПечатнойФормыОС6_2003(МассивОбъектов, ДатаСведений);
	
	ТекстЗапросаТекущиеСведения = ТекстЗапросаТекущиеСведения(ДатаСведений);
	
	ИспользоватьУчетДМ = ПолучитьФункциональнуюОпцию("ИспользоватьУчетДрагоценныхМатериалов");
	ЕстьПереоценки = Не ДанныеПечатнойФормы.ПоПереоценкам.Пустой();
	
	ПервыйДокумент = Истина;
	
	СведенияАктуальны = Истина;
	
	ВыборкаПереоценок = ДанныеПечатнойФормы.ПоПереоценкам.Выбрать();
	
	ВыборкаОбъектов = ДанныеПечатнойФормы.ПоОбъектам.Выбрать();
	Пока ВыборкаОбъектов.Следующий() Цикл
		
		Запрос = Новый Запрос();
		Запрос.Текст = ТекстЗапросаТекущиеСведения;
		Запрос.УстановитьПараметр("Организация", ВыборкаОбъектов.Организация);
		Запрос.УстановитьПараметр("ДатаСведений", ДатаСведений);
		Запрос.УстановитьПараметр("КонецМесяцаГраница", Новый Граница(КонецМесяца(ДатаСведений), ВидГраницы.Включая));
		Запрос.УстановитьПараметр("ОсновноеСредство", ВыборкаОбъектов.Ссылка);
		Запрос.УстановитьПараметр("СубконтоОС", ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.ОсновныеСредства);
		
		ТекущиеСведенияОС = Запрос.Выполнить().Выбрать();
		ТекущиеСведенияОС.Следующий();
		
		Если НЕ ПервыйДокумент Тогда
			ТабДок.ВывестиГоризонтальныйРазделительСтраниц();
		КонецЕсли;
		
		ПервыйДокумент = Ложь;
		// Запомним номер строки, с которой начали выводить текущий документ.
		НомерСтрокиНачало = ТабДок.ВысотаТаблицы + 1;
		
		СчетУчетаСтоимостиБУ = ТекущиеСведенияОС.СчетУчета;
		СрокИспользования   = ТекущиеСведенияОС.СрокПолезногоИспользования;
		
		Отбор  = Новый Структура( "ОсновноеСредство", ВыборкаОбъектов.Ссылка);
		Подразделение  = ТекущиеСведенияОС.МестонахождениеНаименование;
		
		СведенияОбОрганизации = ФормированиеПечатныхФорм.СведенияОЮрФизЛице(ВыборкаОбъектов.Организация, ТекущаяДатаСеанса());
		
		Шапка.Параметры.Заполнить(ВыборкаОбъектов);
		Шапка.Параметры.Заполнить(ТекущиеСведенияОС);
		
		Шапка.Параметры.Организация = ОбщегоНазначенияБПВызовСервера.ОписаниеОрганизации(СведенияОбОрганизации, "НаименованиеДляПечатныхФорм");
		Шапка.Параметры.КодПоОКПО = ВыборкаОбъектов.Организация.КодПоОКПО;
		Шапка.Параметры.Подразделение = Подразделение;
		Шапка.Параметры.НаименованиеОС = ?(НЕ ЗначениеЗаполнено(ВыборкаОбъектов.НаименованиеПолное), ВыборкаОбъектов.Наименование, ВыборкаОбъектов.НаименованиеПолное);
		
		Шапка.Параметры.НомерДок = ТекущиеСведенияОС.ИнвентарныйНомер;
		Шапка.Параметры.ДатаДок = Формат(ДатаСведений,"ДЛФ=D");
		Шапка.Параметры.МестоНахождениеОС = Подразделение;
		Шапка.Параметры.ИзготовительОС = ВыборкаОбъектов.Изготовитель;
		Шапка.Параметры.НомерГруппы = ТекущиеСведенияОС.АмортизационнаяГруппа;
		Если ТекущиеСведенияОС.АмортизационнаяГруппа = 11 Тогда
			Шапка.Параметры.НомерГруппы = НСтр("ru='Отдельная'");
		КонецЕсли;
		Шапка.Параметры.НомерПаспорта = ВыборкаОбъектов.НомерПаспорта;
		Шапка.Параметры.ЗаводскойНомер = ВыборкаОбъектов.ЗаводскойНомер;
		Шапка.Параметры.ИнвентарныйНомер = ТекущиеСведенияОС.ИнвентарныйНомер;
		Шапка.Параметры.СубСчет = Строка(СчетУчетаСтоимостиБУ);
		
		Запрос = Новый Запрос;
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	СостоянияОСОрганизаций.Состояние КАК Состояние,
		|	СостоянияОСОрганизаций.ДатаСостояния КАК ДатаСостояния,
		|	СобытияОСОрганизаций.НазваниеДокумента КАК НазваниеДокумента,
		|	СобытияОСОрганизаций.НомерДокумента КАК НомерДокумента,
		|	СобытияОСОрганизаций.Событие КАК Событие,
		|	СостоянияОСОрганизаций.Регистратор КАК Регистратор
		|ИЗ
		|	РегистрСведений.СобытияОСОрганизаций КАК СобытияОСОрганизаций
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СостоянияОСОрганизаций КАК СостоянияОСОрганизаций
		|		ПО СобытияОСОрганизаций.Период = СостоянияОСОрганизаций.ДатаСостояния
		|			И СобытияОСОрганизаций.Регистратор = СостоянияОСОрганизаций.Регистратор
		|			И СобытияОСОрганизаций.Организация = СостоянияОСОрганизаций.Организация
		|			И СобытияОСОрганизаций.ОсновноеСредство = СостоянияОСОрганизаций.ОсновноеСредство
		|ГДЕ
		|	СобытияОСОрганизаций.ОсновноеСредство = &ОсновноеСредство
		|	И СобытияОСОрганизаций.Период >= &ДатаВводаВЭксплуатациюБУ
		|	И НЕ СобытияОСОрганизаций.Регистратор ССЫЛКА Документ.ПеремещениеОС
		|	И НЕ СобытияОСОрганизаций.Регистратор ССЫЛКА Документ.ПеремещениеОС2_4
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	NULL,
		|	СобытияОСОрганизацийСрезПоследних.Период,
		|	СобытияОСОрганизацийСрезПоследних.НазваниеДокумента,
		|	СобытияОСОрганизацийСрезПоследних.НомерДокумента,
		|	СобытияОСОрганизацийСрезПоследних.Событие,
		|	СобытияОСОрганизацийСрезПоследних.Регистратор
		|ИЗ
		|	РегистрСведений.СобытияОСОрганизаций.СрезПоследних(
		|			&ДатаСведений,
		|			ОсновноеСредство = &ОсновноеСредство
		|				И Событие.ВидСобытияОС В (&МодернизацияИКапРемонт)) КАК СобытияОСОрганизацийСрезПоследних
		|ГДЕ
		|	СобытияОСОрганизацийСрезПоследних.Период >= &ДатаВводаВЭксплуатациюБУ";
		
		Запрос.УстановитьПараметр("Организация", ВыборкаОбъектов.Организация);
		Запрос.УстановитьПараметр("ОсновноеСредство", ВыборкаОбъектов.Ссылка);
		Запрос.УстановитьПараметр("ДатаСведений", ДатаСведений);
		Запрос.УстановитьПараметр("ДатаВводаВЭксплуатациюБУ", ВыборкаОбъектов.ДатаВводаВЭксплуатациюБУ);
		
		ВидыСобытий = Новый СписокЗначений;
		ВидыСобытий.Добавить(Перечисления.ВидыСобытийОС.Модернизация);
		ВидыСобытий.Добавить(Перечисления.ВидыСобытийОС.Достройка);
		ВидыСобытий.Добавить(Перечисления.ВидыСобытийОС.Дооборудование);
		ВидыСобытий.Добавить(Перечисления.ВидыСобытийОС.КапитальныйРемонт);
		
		Запрос.УстановитьПараметр("МодернизацияИКапРемонт", ВидыСобытий);
		Выборка = Запрос.Выполнить().Выбрать();
		
		ДатаПринятия = '00010101';
		ДокументПринятия = "";
		
		ДатаВвода = '00010101';
		ДокументВвода = "";
		ДокументВводаНомер = "";
		
		ДатаСписания = '00010101';
		ДокументСписания = "";
		РегистраторСписания = Неопределено;
		
		Пока Выборка.Следующий() Цикл
			Если Выборка.Состояние = Перечисления.СостоянияОС.ПринятоКУчету
				ИЛИ Выборка.Состояние = Перечисления.СостоянияОС.ПринятоКЗабалансовомуУчету Тогда
				ДатаПринятия = Выборка.ДатаСостояния;
				ДокументПринятия = Выборка.НазваниеДокумента;
				ДокументПринятияНомер = Выборка.НомерДокумента;
			ИначеЕсли Выборка.Состояние = Перечисления.СостоянияОС.СнятоСУчета Тогда
				ДатаСписания        = Выборка.ДатаСостояния;
				ДокументСписания    = Выборка.НазваниеДокумента;
				РегистраторСписания = Выборка.Регистратор;
			Иначе
				ДатаПоследнейМодернизации     = Выборка.ДатаСостояния;
				ДокументПоследнейМодернизации = Выборка.НазваниеДокумента;
			КонецЕсли; 
		КонецЦикла;
		
		Шапка.Параметры.ДатаВвода    = ДатаПринятия;
		Шапка.Параметры.ДатаСписания = ДатаСписания;
		
		ТабДок.Вывести(Шапка);
		
		// Балансовая стоимость ОС на момент поступления и первоначально принятый срок полезного использования.
		ШапкаРазделов1и2.Параметры.Заполнить(ВыборкаОбъектов);
		ШапкаРазделов1и2.Параметры.Заполнить(ТекущиеСведенияОС);
		ШапкаРазделов1и2.Параметры.ПервоначальнаяСтоимость= ТекущиеСведенияОС.ПервоначальнаяСтоимость;
		ШапкаРазделов1и2.Параметры.СрокПолезногоИспользования = ВнеоборотныеАктивыКлиентСервер.РасшифровкаСрокаПолезногоИспользования(СрокИспользования, Ложь);
		Если ЗначениеЗаполнено(ДатаПринятия) Тогда
			ШапкаРазделов1и2.Параметры.ДокументВвода = ДокументПринятия;
			ШапкаРазделов1и2.Параметры.ДокументВводаДата = ДатаПринятия;
			ШапкаРазделов1и2.Параметры.ДокументВводаНомер = ПрефиксацияОбъектовКлиентСервер.НомерНаПечать(ДокументПринятияНомер, Истина, Ложь);
			ШапкаРазделов1и2.Параметры.ДатаКапремонта = ДатаПоследнейМодернизации;
			ШапкаРазделов1и2.Параметры.СрокЭксплуатации = ВнеоборотныеАктивыКлиентСервер.РасшифровкаСрокаПолезногоИспользования(
				УправлениеВнеоборотнымиАктивами.ОпределитьФактическийСрокИспользования(
					ДатаПринятия, ?(ЗначениеЗаполнено(ДатаСписания), ДатаСписания, ТекущаяДатаСеанса())), Ложь);
		КонецЕсли;
		
		ТабДок.Вывести(ШапкаРазделов1и2);
		
		// Переоценки
		ТабДок.Вывести(ШапкаРаздела3);
		Если ЕстьПереоценки Тогда
			ВосстановительнаяСтоимость = ТекущиеСведенияОС.ПервоначальнаяСтоимость;
			ЗаполненныхПереоценок = 0;
			СтруктураПустойСтроки = Новый Структура(
				"ДатаПереоценки1, КоэффициентПереоценки1, ВосстановительнаяСтоимостьПереоценки1,
				|ДатаПереоценки2, КоэффициентПереоценки2, ВосстановительнаяСтоимостьПереоценки2,
				|ДатаПереоценки3, КоэффициентПереоценки3, ВосстановительнаяСтоимостьПереоценки3");
			
			Пока Истина Цикл
				
				Если ЗаполненныхПереоценок = 3 Тогда
					ТабДок.Вывести(СтрокиРаздела3);
					ЗаполненныхПереоценок = 0;
					СтрокиРаздела3.Параметры.Заполнить(СтруктураПустойСтроки);
				КонецЕсли;
				
				Если ВыборкаПереоценок.НайтиСледующий(Отбор) Тогда
					ЗаполненныхПереоценок = ЗаполненныхПереоценок + 1;
					СтрокиРаздела3.Параметры["ДатаПереоценки" + ЗаполненныхПереоценок] = ВыборкаПереоценок.ДатаПереоценки;
					
					СтрокиРаздела3.Параметры["ВосстановительнаяСтоимостьПереоценки" + ЗаполненныхПереоценок] = 
						ВыборкаПереоценок.ВосстановительнаяСтоимостьПереоценки;
					
					СтрокиРаздела3.Параметры["КоэффициентПереоценки" + ЗаполненныхПереоценок] =
						Формат(ВыборкаПереоценок.ВосстановительнаяСтоимостьПереоценки / ВосстановительнаяСтоимость, "ЧЦ=15; ЧДЦ=3");
					
					ВосстановительнаяСтоимость = ВыборкаПереоценок.ВосстановительнаяСтоимостьПереоценки;
				Иначе
					Если ЗаполненныхПереоценок > 0 Тогда
						ТабДок.Вывести(СтрокиРаздела3);
					КонецЕсли;
					Прервать;
				КонецЕсли;
				
			КонецЦикла;
		Иначе
			ТабДок.Вывести(СтрокиРаздела3);
		КонецЕсли;
		
		// Сведения о приемке, внутренних перемещениях и выбытии	
		ТабДок.Вывести(ШапкаРаздела4);
		
		ВыборкаЗаписей = ВыборкаПриемкаПеремещениеВыбытие(ДатаСведений, ВыборкаОбъектов);
		Пока ВыборкаЗаписей.Следующий() Цикл
			
			ТекущаяОперация = ВыборкаЗаписей.Событие;
			
			СтрокаРаздела4.Параметры.Регистратор = ВыборкаЗаписей.Регистратор;
			
			СтрокаРаздела4.Параметры.ДатаНомерДокумента = СтрШаблон(
				НСтр("ru='%1 № %2 от %3'"),
				Строка(ВыборкаЗаписей.НазваниеДокумента),
				ПрефиксацияОбъектовКлиентСервер.НомерНаПечать(ВыборкаЗаписей.НомерДокумента),
				Формат(ВыборкаЗаписей.Период,"ДЛФ=D"));
			
			СтрокаРаздела4.Параметры.ВидОперации = ТекущаяОперация;
			СтрокаРаздела4.Параметры.ФИОМОЛДвижения = "";
			СтрокаРаздела4.Параметры.Подразделение = "";
			СтрокаРаздела4.Параметры.ФИОМОЛДвижения = ВыборкаЗаписей.МОЛ;
			СтрокаРаздела4.Параметры.Подразделение = ВыборкаЗаписей.Местонахождение;
				
			Если ВыборкаЗаписей.СтоимостьОборот = NULL И ВыборкаЗаписей.АмортизацияОборот = NULL Тогда // ввод начальных остатков
				
				СтрокаРаздела4.Параметры.ОстаточнаяСтоимость = ТекущиеСведенияОС.ПервоначальнаяСтоимость;
				
			Иначе
				
				СтрокаРаздела4.Параметры.ОстаточнаяСтоимость = ВыборкаЗаписей.ОстаточнаяСтоимость;
				
			КонецЕсли;
			
			ТабДок.Вывести(СтрокаРаздела4);
			
		КонецЦикла;
		
		ТабДок.Вывести(ПодвалСтраницы1);
		
		// Модернизация ОС и ремонт
		ТабДок.Вывести(ШапкаРазделов5и6);
		
		СписокМодернизаций = Новый Массив;
		СписокМодернизаций.Добавить(Перечисления.ВидыСобытийОС.Модернизация);
		СписокМодернизаций.Добавить(Перечисления.ВидыСобытийОС.Достройка);
		СписокМодернизаций.Добавить(Перечисления.ВидыСобытийОС.Реконструкция);
		СписокМодернизаций.Добавить(Перечисления.ВидыСобытийОС.Дооборудование);
		СписокМодернизаций.Добавить(Перечисления.ВидыСобытийОС.ЧастичнаяЛиквидация);
		
		Запрос = Новый Запрос;
		Запрос.УстановитьПараметр("Организация", ВыборкаОбъектов.Организация);
		Запрос.УстановитьПараметр("ОсновноеСредство", ВыборкаОбъектов.Ссылка);
		Запрос.УстановитьПараметр("УсловиеМодернизаций", СписокМодернизаций);
		Запрос.УстановитьПараметр("ТекстМодернизация", НСтр("ru = 'Модернизация'"));
		Запрос.УстановитьПараметр("ТекстРазукомплектация", НСтр("ru = 'Разукомплектация'"));
		Запрос.УстановитьПараметр("ТекстЧастичнаяЛиквидация", НСтр("ru = 'Частичная ликвидация'"));
		
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	СобытияОСОрганизаций.СуммаЗатратБУ КАК СуммаЗатратБУМодернизаций,
		|	СобытияОСОрганизаций.Регистратор КАК Регистратор,
		|	СобытияОСОрганизаций.Период КАК Период,
		|	СобытияОСОрганизаций.Событие КАК Операция,
		|	СобытияОСОрганизаций.НомерДокумента КАК НомерДокумента,
		|	ВЫРАЗИТЬ(СобытияОСОрганизаций.НазваниеДокумента КАК СТРОКА(200)) КАК НазваниеДокумента
		|ИЗ
		|	РегистрСведений.СобытияОСОрганизаций КАК СобытияОСОрганизаций
		|ГДЕ
		|	СобытияОСОрганизаций.Организация = &Организация
		|	И СобытияОСОрганизаций.Событие.ВидСобытияОС В (&УсловиеМодернизаций)
		|	И СобытияОСОрганизаций.ОсновноеСредство = &ОсновноеСредство
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	СобытияОСОрганизаций.СуммаЗатратБУ КАК СуммаЗатратБУМодернизаций,
		|	СобытияОСОрганизаций.Регистратор КАК Регистратор,
		|	СобытияОСОрганизаций.Период КАК Период,
		|	ВЫБОР
		|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.МодернизацияОС2_4)
		|			ТОГДА &ТекстМодернизация 
		|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.СписаниеОС2_4)
		|			ТОГДА &ТекстЧастичнаяЛиквидация 
		|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.РазукомплектацияОС)
		|			ТОГДА &ТекстРазукомплектация 
		|	КОНЕЦ КАК Операция,
		|	СобытияОСОрганизаций.НомерДокумента КАК НомерДокумента,
		|	ВЫРАЗИТЬ(СобытияОСОрганизаций.НазваниеДокумента КАК СТРОКА(200)) КАК НазваниеДокумента
		|ИЗ
		|	РегистрСведений.СобытияОСОрганизаций КАК СобытияОСОрганизаций
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РазукомплектацияОС КАК РазукомплектацияОС
		|		ПО РазукомплектацияОС.Ссылка = СобытияОСОрганизаций.Регистратор
		|			И РазукомплектацияОС.ОсновноеСредство = СобытияОСОрганизаций.ОсновноеСредство
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СписаниеОС2_4 КАК СписаниеОС2_4
		|		ПО СписаниеОС2_4.Ссылка = СобытияОСОрганизаций.Регистратор
		|ГДЕ
		|	СобытияОСОрганизаций.Организация = &Организация
		|	И СобытияОСОрганизаций.ОсновноеСредство = &ОсновноеСредство
		|	И (ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.МодернизацияОС2_4)
		|		ИЛИ ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.РазукомплектацияОС)
		|			И НЕ РазукомплектацияОС.ОсновноеСредство ЕСТЬ NULL
		|		ИЛИ ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.СписаниеОС2_4)
		|			И СписаниеОС2_4.ЧастичнаяЛиквидация)
		|
		|УПОРЯДОЧИТЬ ПО
		|	Период,
		|	Регистратор";
		
		Результат = Запрос.Выполнить();
		
		ТаблицаИзмененияСтоимости = Новый ТаблицаЗначений;
		ТаблицаИзмененияСтоимости.Колонки.Добавить("Модернизация");
		ТаблицаИзмененияСтоимости.Колонки.Добавить("ДокМодернизации");
		ТаблицаИзмененияСтоимости.Колонки.Добавить("ДокМодернизацииДата");
		ТаблицаИзмененияСтоимости.Колонки.Добавить("ДокМодернизацииНомер");
		ТаблицаИзмененияСтоимости.Колонки.Добавить("ЗатратыНаМодернизацию");
		
		ВыборкаРегистраторов = Результат.Выбрать();
		Пока ВыборкаРегистраторов.Следующий() Цикл
			
			НоваяСтрока = ТаблицаИзмененияСтоимости.Добавить();
			НоваяСтрока.Модернизация = ВыборкаРегистраторов.Операция;
			НоваяСтрока.ДокМодернизации = ВыборкаРегистраторов.НазваниеДокумента;
			НоваяСтрока.ДокМодернизацииНомер = ПрефиксацияОбъектовКлиентСервер.НомерНаПечать(ВыборкаРегистраторов.НомерДокумента);
			НоваяСтрока.ДокМодернизацииДата = Формат(ВыборкаРегистраторов.Период, "ДЛФ=D");
			НоваяСтрока.ЗатратыНаМодернизацию = ВыборкаРегистраторов.СуммаЗатратБУМодернизаций;
			
		КонецЦикла;
		
		КоличествоСтрок = ТаблицаИзмененияСтоимости.Количество(); 
		
		
		Для СчетСтрок = 1 По КоличествоСтрок Цикл
			
			ПараметрыОбласти = Новый Структура(
			"Модернизация,ДокМодернизации,ДокМодернизацииДата,ДокМодернизацииНомер,ЗатратыНаМодернизацию,
			|Ремонт,ДокРемонта,ДокРемонтаНаименование,ДокРемонтаДата,ДокРемонтаНомер,ЗатратыНаРемонт");
			
			Если СчетСтрок <= ТаблицаИзмененияСтоимости.Количество() Тогда
				СтрокаТаблицы = ТаблицаИзмененияСтоимости.Получить(СчетСтрок - 1);
				ЗаполнитьЗначенияСвойств(ПараметрыОбласти, СтрокаТаблицы);
			КонецЕсли;
			
			
			СтрокаРазделов5и6.Параметры.Заполнить(ПараметрыОбласти);
			
			ТабДок.Вывести(СтрокаРазделов5и6);
			
		КонецЦикла;
		
		ТабДок.Вывести(ШапкаРаздела7_1);
		ТаблицаДМ = ВыборкаОбъектов.ДрагоценныеМатериалы.Выгрузить();
		Если ИспользоватьУчетДМ И ТаблицаДМ.Количество() <> 0 Тогда
			Для Каждого Строка Из ТаблицаДМ Цикл
				СтрокиРаздела7_1.Параметры.Заполнить(Строка);
				ТабДок.Вывести(СтрокиРаздела7_1);
			КонецЦикла;
		Иначе
			Для к=0 По 6 Цикл // Вывод пустых строк для заполнения вручную
				ТабДок.Вывести(СтрокиРаздела7_1);
			КонецЦикла;
		КонецЕсли;
		ТабДок.Вывести(ШапкаРаздела7_2);
		ТабДок.Вывести(ПодвалСтраницы2);
		
		// В табличном документе зададим имя области, в которую был 
		// выведен объект. Нужно для возможности печати покомплектно.
		УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабДок, НомерСтрокиНачало, ОбъектыПечати, ВыборкаОбъектов.Ссылка);
		
		Если НЕ ВыборкаОбъектов.СведенияАктуальны Тогда
			СведенияАктуальны = Ложь;
		КонецЕсли; 
		
	КонецЦикла;
	
	ВнеоборотныеАктивы.ДобавитьПредупреждениеЕслиСведенияНеАктуальны(СведенияАктуальны, ТабДок);
	
	Возврат ТабДок;
	
КонецФункции

Функция ДанныеПечатнойФормыОС6_2003(МассивОбъектов, ДатаСведений)

	СписокЗапросов = Новый Массив;
	
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	СведенияПоОрганизации.ОсновноеСредство КАК ОС,
	|	СведенияПоОрганизации.Организация КАК Организация,
	|	ЕСТЬNULL(ПервоначальныеСведенияОС.ДатаВводаВЭксплуатациюБУ, ДАТАВРЕМЯ(1,1,1)) КАК ДатаВводаВЭксплуатациюБУ
	|ПОМЕСТИТЬ СведенияПоОрганизации
	|ИЗ
	|	РегистрСведений.ПервоначальныеСведенияОСБухгалтерскийУчет.СрезПоследних(&ДатаСведений, ОсновноеСредство В (&МассивОбъектов)) КАК СведенияПоОрганизации
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ПервоначальныеСведенияОС.СрезПоследних(&ДатаСведений, ОсновноеСредство В (&МассивОбъектов)) КАК ПервоначальныеСведенияОС
	|		ПО СведенияПоОрганизации.ОсновноеСредство = ПервоначальныеСведенияОС.ОсновноеСредство
	|			И СведенияПоОрганизации.Организация = ПервоначальныеСведенияОС.Организация
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ОС
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ОсновныеСредства.Ссылка КАК Ссылка,
	|	ОсновныеСредства.Код КАК Код,
	|	ОсновныеСредства.Наименование КАК Наименование,
	|	ОсновныеСредства.ДатаВыпуска КАК ДатаВыпуска,
	|	ОсновныеСредства.ЗаводскойНомер КАК ЗаводскойНомер,
	|	ОсновныеСредства.Изготовитель КАК Изготовитель,
	|	ОсновныеСредства.НаименованиеПолное КАК НаименованиеПолное,
	|	ОсновныеСредства.НомерПаспорта КАК НомерПаспорта,
	|	ЕСТЬNULL(СведенияПоОрганизации.Организация, ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)) КАК Организация,
	|	СведенияПоОрганизации.ДатаВводаВЭксплуатациюБУ КАК ДатаВводаВЭксплуатациюБУ,
	|	НЕ ОсновныеСредства.Ссылка В (&ОбъектыДляКоторыхСведенияНеАктуальны) КАК СведенияАктуальны,
	|	ОсновныеСредства.ДрагоценныеМатериалы.(
	|		ДрагоценныйМатериал КАК ДрагоценныйМатериал,
	|		Количество КАК Количество,
	|		ЕдиницаИзмерения КАК ЕдиницаИзмерения
	|	) КАК ДрагоценныеМатериалы
	|ИЗ
	|	Справочник.ОбъектыЭксплуатации КАК ОсновныеСредства
	|		ЛЕВОЕ СОЕДИНЕНИЕ СведенияПоОрганизации КАК СведенияПоОрганизации
	|		ПО ОсновныеСредства.Ссылка = СведенияПоОрганизации.ОС
	|ГДЕ
	|	ОсновныеСредства.Ссылка В(&МассивОбъектов)
	|	И ОсновныеСредства.ЭтоГруппа = ЛОЖЬ
	|
	|УПОРЯДОЧИТЬ ПО
	|	Наименование
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Переоценка.Дата КАК ДатаПереоценки,
	|	ПереоценкаТЧ.ОсновноеСредство КАК ОсновноеСредство,
	|	ПереоценкаТЧ.Стоимость КАК ВосстановительнаяСтоимостьПереоценки
	|ИЗ
	|	СведенияПоОрганизации КАК СведенияПоОрганизации
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.СобытияОСОрганизаций КАК СобытияОСОрганизаций
	|		ПО СведенияПоОрганизации.ОС = СобытияОСОрганизаций.ОсновноеСредство
	|			И СведенияПоОрганизации.Организация = СобытияОСОрганизаций.Организация
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ПереоценкаОС.ОС КАК ПереоценкаТЧ
	|		ПО (СобытияОСОрганизаций.Регистратор = ПереоценкаТЧ.Ссылка)
	|			И (СобытияОСОрганизаций.ОсновноеСредство = ПереоценкаТЧ.ОсновноеСредство)
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ПереоценкаОС КАК Переоценка
	|		ПО (СобытияОСОрганизаций.Регистратор = Переоценка.Ссылка)
	|ГДЕ
	|	СобытияОСОрганизаций.Событие.ВидСобытияОС = &ВидСобытияПереоценки
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	Переоценка.Дата КАК ДатаПереоценки,
	|	ПереоценкаТЧ.ОсновноеСредство КАК ОсновноеСредство,
	|	ПереоценкаТЧ.СтоимостьБУ КАК ВосстановительнаяСтоимостьПереоценки
	|ИЗ
	|	СведенияПоОрганизации КАК СведенияПоОрганизации
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.СобытияОСОрганизаций КАК СобытияОСОрганизаций
	|		ПО СобытияОСОрганизаций.ОсновноеСредство = СведенияПоОрганизации.ОС
	|			И СобытияОСОрганизаций.Период >= СведенияПоОрганизации.ДатаВводаВЭксплуатациюБУ
	|			И СобытияОСОрганизаций.Регистратор ССЫЛКА Документ.ПереоценкаОС2_4
	|	
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ПереоценкаОС2_4.ОС КАК ПереоценкаТЧ
	|		ПО (СобытияОСОрганизаций.Регистратор = ПереоценкаТЧ.Ссылка)
	|			И (СобытияОСОрганизаций.ОсновноеСредство = ПереоценкаТЧ.ОсновноеСредство)
	|
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ПереоценкаОС2_4 КАК Переоценка
	|		ПО (СобытияОСОрганизаций.Регистратор = Переоценка.Ссылка)
	|
	|УПОРЯДОЧИТЬ ПО
	|	ОсновноеСредство,
	|	ДатаПереоценки";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	ТекстЗапроса = СтрСоединить(СписокЗапросов, ОбщегоНазначения.РазделительПакетаЗапросов());
	
	Запрос = Новый Запрос(ТекстЗапроса);
	Запрос.УстановитьПараметр("ДатаСведений", ДатаСведений);
	Запрос.УстановитьПараметр("МассивОбъектов", МассивОбъектов);
	Запрос.УстановитьПараметр("ВидСобытияПереоценки", Перечисления.ВидыСобытийОС.Переоценка);
	Запрос.УстановитьПараметр("НаименованиеДокРемонта", НСтр("ru = 'Заказ на ремонт'"));
	
	ОбъектыДляКоторыхСведенияНеАктуальны = ВнеоборотныеАктивы.ОбъектыДляКоторыхСведенияНеАктуальны(МассивОбъектов, ДатаСведений);
	Запрос.УстановитьПараметр("ОбъектыДляКоторыхСведенияНеАктуальны", ОбъектыДляКоторыхСведенияНеАктуальны);
	
	Пакет = Запрос.ВыполнитьПакет();

	ДанныеПечатнойФормы = Новый Структура;
	ДанныеПечатнойФормы.Вставить("ПоОбъектам", Пакет[Пакет.ВГраница()-1]);
	ДанныеПечатнойФормы.Вставить("ПоПереоценкам", Пакет[Пакет.ВГраница()]);
	
	Возврат ДанныеПечатнойФормы;
	
КонецФункции

Функция ТекстЗапросаТекущиеСведения(ДатаСведений)

	СписокЗапросов = Новый Массив;
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	СчетаБухгалтерскогоУчета.ОсновноеСредство КАК ОсновноеСредство,
	|	ВЫБОР
	|		КОГДА СчетаБухгалтерскогоУчета.ГруппаФинансовогоУчета <> ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаВнеоборотныхАктивов.ПустаяСсылка)
	|			ТОГДА СчетаБухгалтерскогоУчета.ГруппаФинансовогоУчета.СчетУчета
	|		ИНАЧЕ СчетаБухгалтерскогоУчета.СчетУчета
	|	КОНЕЦ КАК СчетУчета,
	|	ВЫБОР
	|		КОГДА СчетаБухгалтерскогоУчета.ГруппаФинансовогоУчета <> ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаВнеоборотныхАктивов.ПустаяСсылка)
	|			ТОГДА СчетаБухгалтерскогоУчета.ГруппаФинансовогоУчета.СчетУчетаАмортизации
	|		ИНАЧЕ СчетаБухгалтерскогоУчета.СчетНачисленияАмортизации
	|	КОНЕЦ КАК СчетНачисленияАмортизации,
	|	ВЫБОР
	|		КОГДА СчетаБухгалтерскогоУчета.ГруппаФинансовогоУчета <> ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаВнеоборотныхАктивов.ПустаяСсылка)
	|			ТОГДА СчетаБухгалтерскогоУчета.ГруппаФинансовогоУчета.СчетЗабалансовогоУчета
	|		ИНАЧЕ СчетаБухгалтерскогоУчета.СчетУчета
	|	КОНЕЦ КАК СчетЗабалансовогоУчета
	|ПОМЕСТИТЬ втСчетаУчета
	|ИЗ
	|	РегистрСведений.СчетаБухгалтерскогоУчетаОС.СрезПоследних(
	|			&ДатаСведений,
	|			Организация = &Организация
	|				И ОсновноеСредство = &ОсновноеСредство) КАК СчетаБухгалтерскогоУчета
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ТаблицаПервоначальныеСведения.ОсновноеСредство КАК ОсновноеСредство,
	|	ТаблицаПервоначальныеСведения.СпособНачисленияАмортизации КАК СпособНачисленияАмортизации,
	|	ТаблицаПервоначальныеСведения.ПервоначальнаяСтоимость КАК ПервоначальнаяСтоимость,
	|	ТаблицаПервоначальныеСведения.ИнвентарныйНомер КАК ИнвентарныйНомер,
	|	ТаблицаПервоначальныеСведения.ГруппаОС КАК ГруппаОС,
	|	ТаблицаПервоначальныеСведения.КодПоОКОФ.Код КАК КодПоОКОФ,
	|	ТаблицаПервоначальныеСведения.ШифрПоЕНАОФ КАК ШифрПоЕНАОФ,
	|	ТаблицаПервоначальныеСведения.АмортизационнаяГруппа.Порядок + 1 КАК АмортизационнаяГруппа,
	|	ТаблицаПервоначальныеСведения.Арендодатель КАК Арендодатель
	|ПОМЕСТИТЬ ТаблицаПервоначальныеСведения
	|ИЗ
	|	РегистрСведений.ПервоначальныеСведенияОСБухгалтерскийУчет.СрезПоследних(
	|			&ДатаСведений,
	|			Организация = &Организация
	|				И ОсновноеСредство = &ОсновноеСредство) КАК ТаблицаПервоначальныеСведения
	|ГДЕ
	|	ТаблицаПервоначальныеСведения.Организация = &Организация
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ОсновноеСредство
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ТаблицаПараметрыАмортизации.ОсновноеСредство КАК ОсновноеСредство,
	|	ТаблицаПараметрыАмортизации.СтоимостьДляВычисленияАмортизации КАК СтоимостьДляВычисленияАмортизации,
	|	ТаблицаПараметрыАмортизации.ОбъемПродукцииРаботДляВычисленияАмортизации КАК ОбъемПродукцииРаботДляВычисленияАмортизации,
	|	ТаблицаПараметрыАмортизации.КоэффициентАмортизации КАК КоэффициентАмортизации,
	|	ТаблицаПараметрыАмортизации.КоэффициентУскорения КАК КоэффициентУскорения,
	|	ТаблицаПараметрыАмортизации.СрокПолезногоИспользования КАК СрокПолезногоИспользования,
	|	ТаблицаПараметрыАмортизации.Период КАК Период
	|ПОМЕСТИТЬ ТаблицаПараметрыАмортизации
	|ИЗ
	|	РегистрСведений.ПараметрыАмортизацииОСБухгалтерскийУчет.СрезПоследних(
	|			&ДатаСведений,
	|			Организация = &Организация
	|				И ОсновноеСредство = &ОсновноеСредство) КАК ТаблицаПараметрыАмортизации
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ОсновноеСредство
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ТаблицаМестонахождение.ОсновноеСредство КАК ОсновноеСредство,
	|	ТаблицаМестонахождение.Местонахождение КАК Местонахождение,
	|	ТаблицаМестонахождение.МОЛ КАК МОЛ
	|ПОМЕСТИТЬ ТаблицаМестонахождение
	|ИЗ
	|	РегистрСведений.МестонахождениеОСБухгалтерскийУчет.СрезПоследних(
	|			&ДатаСведений,
	|			Организация = &Организация
	|				И ОсновноеСредство = &ОсновноеСредство) КАК ТаблицаМестонахождение
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ОсновноеСредство
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ТаблицаСостоянияОС.ОсновноеСредство КАК ОсновноеСредство,
	|	ТаблицаСостоянияОС.Состояние КАК Состояние
	|ПОМЕСТИТЬ ТаблицаСостоянияОС
	|ИЗ
	|	РегистрСведений.СостоянияОСОрганизаций.СрезПоследних(
	|			&ДатаСведений,
	|			Организация = &Организация
	|				И ОсновноеСредство = &ОсновноеСредство) КАК ТаблицаСостоянияОС
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	ОсновноеСредство";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	Если ВнеоборотныеАктивы.ИспользуетсяУправлениеВНА_2_4(ДатаСведений) Тогда
		
		ТекстЗапроса =
		"ВЫБРАТЬ
		|	ТаблицаСтоимость.ОсновноеСредство КАК ОсновноеСредство,
		|	НЕОПРЕДЕЛЕНО КАК СчетУчета,
		|	ТаблицаСтоимость.СтоимостьРеглОстаток + ТаблицаСтоимость.СтоимостьЦФОстаток КАК СуммаОстаток
		|ПОМЕСТИТЬ ТаблицаСтоимость
		|ИЗ
		|	РегистрНакопления.СтоимостьОС.Остатки(
		|			&ДатаСведений,
		|			Организация = &Организация
		|				И ОсновноеСредство = &ОсновноеСредство) КАК ТаблицаСтоимость
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ОсновноеСредство
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ТаблицаАмортизация.ОсновноеСредство КАК ОсновноеСредство,
		|	НЕОПРЕДЕЛЕНО КАК СчетНачисленияАмортизации,
		|	-ТаблицаАмортизация.АмортизацияРеглОстаток -ТаблицаАмортизация.АмортизацияЦФОстаток КАК СуммаОстаток
		|ПОМЕСТИТЬ ТаблицаАмортизация
		|ИЗ
		|	РегистрНакопления.АмортизацияОС.Остатки(
		|			&КонецМесяцаГраница,
		|			Организация = &Организация
		|				И ОсновноеСредство = &ОсновноеСредство) КАК ТаблицаАмортизация
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ОсновноеСредство";
		
		СписокЗапросов.Добавить(ТекстЗапроса);
		
	Иначе
		
		ТекстЗапроса =
		"ВЫБРАТЬ
		|	ХозрасчетныйОстаткиСчетУчета.Субконто1 КАК ОсновноеСредство,
		|	ХозрасчетныйОстаткиСчетУчета.Счет КАК СчетУчета,
		|	ХозрасчетныйОстаткиСчетУчета.СуммаОстаток КАК СуммаОстаток
		|ПОМЕСТИТЬ ТаблицаСтоимость
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.Остатки(
		|			&ДатаСведений,
		|			Счет В
		|				(ВЫБРАТЬ
		|					втСчетаУчета.СчетУчета
		|				ИЗ
		|					втСчетаУчета КАК втСчетаУчета),
		|			&СубконтоОС,
		|			Организация = &Организация
		|				И Субконто1 = &ОсновноеСредство) КАК ХозрасчетныйОстаткиСчетУчета
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ОсновноеСредство,
		|	СчетУчета
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ХозрасчетныйОстаткиСчетАмортизации.Субконто1 КАК ОсновноеСредство,
		|	ХозрасчетныйОстаткиСчетАмортизации.Счет КАК СчетНачисленияАмортизации,
		|	-ХозрасчетныйОстаткиСчетАмортизации.СуммаОстаток КАК СуммаОстаток
		|ПОМЕСТИТЬ ТаблицаАмортизация
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.Остатки(
		|			&ДатаСведений,
		|			Счет В
		|				(ВЫБРАТЬ
		|					втСчетаУчета.СчетНачисленияАмортизации
		|				ИЗ
		|					втСчетаУчета КАК втСчетаУчета),
		|			&СубконтоОС,
		|			Организация = &Организация
		|				И Субконто1 = &ОсновноеСредство) КАК ХозрасчетныйОстаткиСчетАмортизации
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ОсновноеСредство,
		|	СчетНачисленияАмортизации";
		
		СписокЗапросов.Добавить(ТекстЗапроса);
		
	КонецЕсли; 
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ТаблицаПараметрыАмортизации.СтоимостьДляВычисленияАмортизации КАК СтоимостьДляВычисленияАмортизации,
	|	ТаблицаПараметрыАмортизации.ОбъемПродукцииРаботДляВычисленияАмортизации КАК ОбъемПродукцииРаботДляВычисленияАмортизации,
	|	ТаблицаПараметрыАмортизации.КоэффициентАмортизации КАК КоэффициентАмортизации,
	|	ТаблицаПараметрыАмортизации.КоэффициентУскорения КАК КоэффициентУскорения,
	|	ТаблицаПараметрыАмортизации.СрокПолезногоИспользования КАК СрокПолезногоИспользования,
	|	ТаблицаПараметрыАмортизации.Период КАК Период,
	|	ВЫБОР
	|		КОГДА ТаблицаПервоначальныеСведения.Арендодатель <> ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
	|			ТОГДА ТаблицаСчетаБухгалтерскогоУчета.СчетЗабалансовогоУчета
	|		ИНАЧЕ ТаблицаСчетаБухгалтерскогоУчета.СчетУчета
	|	КОНЕЦ КАК СчетУчета,
	|	ТаблицаСчетаБухгалтерскогоУчета.СчетНачисленияАмортизации КАК СчетНачисленияАмортизации,
	|	ТаблицаМестонахождение.Местонахождение КАК Местонахождение,
	|	ТаблицаМестонахождение.МОЛ КАК МОЛ,
	|	ТаблицаМестонахождение.Местонахождение.Наименование КАК МестонахождениеНаименование,
	|	ТаблицаПервоначальныеСведения.СпособНачисленияАмортизации КАК СпособНачисленияАмортизации,
	|	ВЫБОР
	|		КОГДА ТаблицаСостоянияОС.Состояние = ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПринятоКЗабалансовомуУчету)
	|			ТОГДА 0
	|		ИНАЧЕ ТаблицаПервоначальныеСведения.ПервоначальнаяСтоимость 
	|	КОНЕЦ КАК ПервоначальнаяСтоимость,
	|	ТаблицаПервоначальныеСведения.ОсновноеСредство КАК ОсновноеСредство,
	|	ТаблицаПервоначальныеСведения.ИнвентарныйНомер КАК ИнвентарныйНомер,
	|	ТаблицаПервоначальныеСведения.ГруппаОС КАК ГруппаОС,
	|	ТаблицаПервоначальныеСведения.КодПоОКОФ КАК КодПоОКОФ,
	|	ТаблицаПервоначальныеСведения.ШифрПоЕНАОФ КАК ШифрПоЕНАОФ,
	|	ТаблицаПервоначальныеСведения.АмортизационнаяГруппа КАК АмортизационнаяГруппа,
	|	ВЫБОР
	|		КОГДА ТаблицаСостоянияОС.Состояние В (
	|				ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПринятоКУчету),
	|				ЗНАЧЕНИЕ(Перечисление.СостоянияОС.ПринятоКЗабалансовомуУчету))
	|			ТОГДА ЕСТЬNULL(ТаблицаСтоимость.СуммаОстаток, 0) - ЕСТЬNULL(ТаблицаАмортизация.СуммаОстаток, 0)
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ОстаточнаяСтоимость,
	|	ЕСТЬNULL(ТаблицаАмортизация.СуммаОстаток, 0) КАК СуммаНачисленнойАмортизации
	|ИЗ
	|	ТаблицаПервоначальныеСведения КАК ТаблицаПервоначальныеСведения
	|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаПараметрыАмортизации КАК ТаблицаПараметрыАмортизации
	|		ПО ТаблицаПервоначальныеСведения.ОсновноеСредство = ТаблицаПараметрыАмортизации.ОсновноеСредство
	|		ЛЕВОЕ СОЕДИНЕНИЕ втСчетаУчета КАК ТаблицаСчетаБухгалтерскогоУчета
	|		ПО ТаблицаПервоначальныеСведения.ОсновноеСредство = ТаблицаСчетаБухгалтерскогоУчета.ОсновноеСредство
	|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаМестонахождение КАК ТаблицаМестонахождение
	|		ПО ТаблицаПервоначальныеСведения.ОсновноеСредство = ТаблицаМестонахождение.ОсновноеСредство
	|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаСостоянияОС КАК ТаблицаСостоянияОС
	|		ПО ТаблицаПервоначальныеСведения.ОсновноеСредство = ТаблицаСостоянияОС.ОсновноеСредство
	|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаСтоимость КАК ТаблицаСтоимость
	|		ПО (ТаблицаСчетаБухгалтерскогоУчета.ОсновноеСредство = ТаблицаСтоимость.ОсновноеСредство)
	|			И (ТаблицаСчетаБухгалтерскогоУчета.СчетУчета = ТаблицаСтоимость.СчетУчета
	|				ИЛИ ТаблицаСтоимость.СчетУчета = НЕОПРЕДЕЛЕНО)
	|		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаАмортизация КАК ТаблицаАмортизация
	|		ПО (ТаблицаСчетаБухгалтерскогоУчета.ОсновноеСредство = ТаблицаАмортизация.ОсновноеСредство)
	|			И (ТаблицаСчетаБухгалтерскогоУчета.СчетНачисленияАмортизации = ТаблицаАмортизация.СчетНачисленияАмортизации
	|				ИЛИ ТаблицаАмортизация.СчетНачисленияАмортизации = НЕОПРЕДЕЛЕНО)";
	
	СписокЗапросов.Добавить(ТекстЗапроса);
	
	ТекстЗапроса = СтрСоединить(СписокЗапросов, ОбщегоНазначения.РазделительПакетаЗапросов());

	Возврат ТекстЗапроса;
	
КонецФункции

Функция ВыборкаПриемкаПеремещениеВыбытие(ДатаСведений, ВыборкаОбъектов)

	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	Запрос.УстановитьПараметр("Период", ДатаСведений);
	Запрос.УстановитьПараметр("Организация", ВыборкаОбъектов.Организация);
	Запрос.УстановитьПараметр("ОсновноеСредство", ВыборкаОбъектов.Ссылка);
	Запрос.УстановитьПараметр("ДатаВводаВЭксплуатациюБУ", ВыборкаОбъектов.ДатаВводаВЭксплуатациюБУ);
	Запрос.УстановитьПараметр("ТекстПринятиеКУчету",      НСтр("ru = 'Принятие к учету'"));
	Запрос.УстановитьПараметр("ТекстПеремещение",         НСтр("ru = 'Внутреннее перемещение'"));
	Запрос.УстановитьПараметр("ТекстСписание",            НСтр("ru = 'Списание'"));
	Запрос.УстановитьПараметр("ТекстПодготовкаКПередаче", НСтр("ru = 'Подготовка к передаче'"));
	Запрос.УстановитьПараметр("ТекстРазукомплектацияОС",  НСтр("ru = 'Разукомплектация'"));
	Запрос.УстановитьПараметр("ТекстВыбытие",             НСтр("ru = 'Выбытие'"));
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	СобытияОС.Ссылка
	|ПОМЕСТИТЬ втСписокСобытий
	|ИЗ
	|	Справочник.СобытияОС КАК СобытияОС
	|ГДЕ
	|	СобытияОС.ВидСобытияОС В (
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.ПринятиеКУчету), 
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.ПринятиеКУчетуСВводомВЭксплуатацию), 
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.ВнутреннееПеремещение), 
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.Списание), 
	|		ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.Передача))
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	СобытияОСОрганизаций.Организация КАК Организация,
	|	СобытияОСОрганизаций.ОсновноеСредство КАК ОсновноеСредство,
	|	СобытияОСОрганизаций.НазваниеДокумента КАК НазваниеДокумента,
	|	СобытияОСОрганизаций.НомерДокумента КАК НомерДокумента,
	|	СобытияОСОрганизаций.Период КАК Период,
	|	СобытияОСОрганизаций.Период КАК ПериодОстатков,
	|	СобытияОСОрганизаций.Событие КАК Событие,
	|	СобытияОСОрганизаций.Событие.ВидСобытияОС КАК ВидСобытияОС,
	|	СобытияОСОрганизаций.Регистратор КАК Регистратор
	|ПОМЕСТИТЬ СобытияОС
	|ИЗ
	|	РегистрСведений.СобытияОСОрганизаций КАК СобытияОСОрганизаций
	|ГДЕ
	|	СобытияОСОрганизаций.ОсновноеСредство = &ОсновноеСредство
	|	И СобытияОСОрганизаций.Период < &Период
	|	И СобытияОСОрганизаций.Событие В (
	|		ВЫБРАТЬ
	|			СобытияОС.Ссылка
	|		ИЗ
	|			втСписокСобытий КАК СобытияОС)
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СобытияОСОрганизаций.Организация КАК Организация,
	|	СобытияОСОрганизаций.ОсновноеСредство КАК ОсновноеСредство,
	|	СобытияОСОрганизаций.НазваниеДокумента КАК НазваниеДокумента,
	|	СобытияОСОрганизаций.НомерДокумента КАК НомерДокумента,
	|	СобытияОСОрганизаций.Период КАК Период,
	|	СобытияОСОрганизаций.Период КАК ПериодОстатков,
	|	ВЫБОР  
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ПринятиеКУчетуОС)
	|			ТОГДА &ТекстПринятиеКУчету
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ПринятиеКУчетуОС2_4)
	|			ТОГДА &ТекстПринятиеКУчету
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.РазукомплектацияОС)
	|				И РазукомплектацияОС.ОсновноеСредство ЕСТЬ NULL
	|			ТОГДА &ТекстПринятиеКУчету
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.РазукомплектацияОС)
	|				И НЕ РазукомплектацияОС.ОсновноеСредство ЕСТЬ NULL
	|			ТОГДА &ТекстРазукомплектацияОС
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ВводОстатковВнеоборотныхАктивов)
	|			ТОГДА &ТекстПринятиеКУчету
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ВводОстатковВнеоборотныхАктивов2_4)
	|			ТОГДА &ТекстПринятиеКУчету
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ПеремещениеОС)
	|			ТОГДА &ТекстПеремещение
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ПеремещениеОС2_4)
	|			ТОГДА &ТекстПеремещение
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.СписаниеОС)
	|			ТОГДА &ТекстСписание
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.СписаниеОС2_4)
	|			ТОГДА &ТекстСписание
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ПодготовкаКПередачеОС)
	|			ТОГДА &ТекстПодготовкаКПередаче
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ПодготовкаКПередачеОС2_4)
	|			ТОГДА &ТекстПодготовкаКПередаче
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ПоступлениеАрендованныхОС)
	|			ТОГДА &ТекстПринятиеКУчету
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ВыбытиеАрендованныхОС)
	|			ТОГДА &ТекстВыбытие
	|	КОНЕЦ КАК Событие,
	|	ВЫБОР  
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ПринятиеКУчетуОС)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.ПринятиеКУчету)
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ПринятиеКУчетуОС2_4)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.ПринятиеКУчету)
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.РазукомплектацияОС)
	|				И РазукомплектацияОС.ОсновноеСредство ЕСТЬ NULL
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.ПринятиеКУчету)
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ВводОстатковВнеоборотныхАктивов)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.ПринятиеКУчету)
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ВводОстатковВнеоборотныхАктивов2_4)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.ПринятиеКУчету)
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ПеремещениеОС)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.ВнутреннееПеремещение)
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ПеремещениеОС2_4)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.ВнутреннееПеремещение)
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.СписаниеОС)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.Списание)
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.СписаниеОС2_4)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.Списание)
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ПодготовкаКПередачеОС)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.Передача)
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ПодготовкаКПередачеОС2_4)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.Передача)
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ПоступлениеАрендованныхОС)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.ПринятиеКУчету)
	|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.ВыбытиеАрендованныхОС)
	|			ТОГДА ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.Списание)
	|	КОНЕЦ КАК ВидСобытияОС,
	|	СобытияОСОрганизаций.Регистратор КАК Регистратор
	|ИЗ
	|	РегистрСведений.СобытияОСОрганизаций КАК СобытияОСОрганизаций
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РазукомплектацияОС КАК РазукомплектацияОС
	|		ПО РазукомплектацияОС.Ссылка = СобытияОСОрганизаций.Регистратор
	|			И РазукомплектацияОС.ОсновноеСредство = СобытияОСОрганизаций.ОсновноеСредство
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СписаниеОС КАК СписаниеОС
	|		ПО СписаниеОС.Ссылка = СобытияОСОрганизаций.Регистратор
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СписаниеОС2_4 КАК СписаниеОС24
	|		ПО СписаниеОС24.Ссылка = СобытияОСОрганизаций.Регистратор
	|		
	|ГДЕ
	|	СобытияОСОрганизаций.ОсновноеСредство = &ОсновноеСредство
	|	И СобытияОСОрганизаций.Период < &Период
	|	И СобытияОСОрганизаций.Период >= &ДатаВводаВЭксплуатациюБУ
	|	И СобытияОСОрганизаций.Событие = ЗНАЧЕНИЕ(Справочник.СобытияОС.ПустаяСсылка)
	|	И (ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) В (
	|			ТИП(Документ.ПринятиеКУчетуОС),
	|			ТИП(Документ.ПринятиеКУчетуОС2_4),
	|			ТИП(Документ.РазукомплектацияОС),
	|			ТИП(Документ.ВводОстатковВнеоборотныхАктивов),
	|			ТИП(Документ.ВводОстатковВнеоборотныхАктивов2_4),
	|			ТИП(Документ.ПеремещениеОС),
	|			ТИП(Документ.ПеремещениеОС2_4),
	|			ТИП(Документ.ПодготовкаКПередачеОС),
	|			ТИП(Документ.ПодготовкаКПередачеОС2_4),
	|			ТИП(Документ.ПоступлениеАрендованныхОС),
	|			ТИП(Документ.ВыбытиеАрендованныхОС))
	|		ИЛИ ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.СписаниеОС)
	|			И НЕ СписаниеОС.ЧастичнаяЛиквидация
	|		ИЛИ ТИПЗНАЧЕНИЯ(СобытияОСОрганизаций.Регистратор) = ТИП(Документ.СписаниеОС2_4)
	|			И НЕ СписаниеОС24.ЧастичнаяЛиквидация
	|	)";
	
	Запрос.Выполнить();
	
	СписокЗапросов = Новый Массив;
	
	Если ВнеоборотныеАктивы.ИспользуетсяУправлениеВНА_2_4(ДатаСведений) Тогда
		
		Запрос.Текст = 
		"ВЫБРАТЬ
		|	СобытияОС.Регистратор КАК Ссылка,
		|	ЕСТЬNULL(ВводОстатков.Дата, ЕСТЬNULL(ВводОстатков2_4.Дата, СобытияОС.Период)) КАК Дата,
		|	СобытияОС.Организация КАК Организация,
		|	СобытияОС.ОсновноеСредство КАК ОсновноеСредство
		|ПОМЕСТИТЬ втОбъектыДокументов
		|ИЗ
		|	СобытияОС КАК СобытияОС
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ВводОстатковВнеоборотныхАктивов КАК ВводОстатков
		|		ПО ВводОстатков.Ссылка = СобытияОС.Регистратор
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ВводОстатковВнеоборотныхАктивов2_4 КАК ВводОстатков2_4
		|		ПО ВводОстатков2_4.Ссылка = СобытияОС.Регистратор
		|
		|ИНДЕКСИРОВАТЬ ПО
		|	ОсновноеСредство,
		|	Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	СобытияОС.Регистратор КАК Регистратор
		|ИЗ
		|	СобытияОС КАК СобытияОС";
		
		Результат = Запрос.Выполнить();
		
		ВнеоборотныеАктивыЛокализация.ПолучитьСведенияОбОсновныхСредствахВДокументах(
			Запрос.МенеджерВременныхТаблиц, 
			Результат.Выгрузить().ВыгрузитьКолонку("Регистратор"));
		
		ТекстЗапроса =
		"ВЫБРАТЬ
		|	ТИПЗНАЧЕНИЯ(СобытияОС.Регистратор) КАК НазваниеДокумента,
		|	СобытияОС.НомерДокумента КАК НомерДокумента,
		|	СобытияОС.Период КАК Период,
		|	СобытияОС.Событие КАК Событие,
		|	СобытияОС.Регистратор КАК Регистратор,
		|	втСведенияОбъектовДокументов.МОЛ КАК МОЛ,
		|	втСведенияОбъектовДокументов.Местонахождение КАК Местонахождение,
		|	втСведенияОбъектовДокументов.СтоимостьОборот КАК СтоимостьОборот,
		|	втСведенияОбъектовДокументов.АмортизацияОборот КАК АмортизацияОборот,
		|	ВЫБОР
		|		КОГДА СобытияОС.ВидСобытияОС = ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.Списание)
		|			ТОГДА ЕСТЬNULL(втСведенияОбъектовДокументов.СтоимостьРасход, 0) - ЕСТЬNULL(втСведенияОбъектовДокументов.АмортизацияРасход, 0)
		|		КОГДА ТИПЗНАЧЕНИЯ(СобытияОС.Регистратор) = ТИП(Документ.ПодготовкаКПередачеОС)
		|				ИЛИ ТИПЗНАЧЕНИЯ(СобытияОС.Регистратор) = ТИП(Документ.ПодготовкаКПередачеОС2_4)
		|			ТОГДА ЕСТЬNULL(втСведенияОбъектовДокументов.СтоимостьРасход, 0) - ЕСТЬNULL(втСведенияОбъектовДокументов.АмортизацияРасход, 0)
		|		ИНАЧЕ ЕСТЬNULL(втСведенияОбъектовДокументов.ОстаточнаяСтоимость, 0)
		|	КОНЕЦ КАК ОстаточнаяСтоимость
		|ИЗ
		|	СобытияОС КАК СобытияОС
		|		ЛЕВОЕ СОЕДИНЕНИЕ втСведенияОбъектовДокументов КАК втСведенияОбъектовДокументов
		|		ПО СобытияОС.Регистратор = втСведенияОбъектовДокументов.Ссылка
		|
		|УПОРЯДОЧИТЬ ПО
		|	Период,
		|	НомерДокумента";

		СписокЗапросов.Добавить(ТекстЗапроса);
		
	Иначе	
		
		ТекстЗапроса =
		"ВЫБРАТЬ
		|	МестонахождениеОСБухгалтерскийУчет.Период КАК Период,
		|	МестонахождениеОСБухгалтерскийУчет.МОЛ КАК МОЛ,
		|	МестонахождениеОСБухгалтерскийУчет.Местонахождение КАК Местонахождение
		|ПОМЕСТИТЬ МестонахождениеОСБухгалтерскийУчет
		|ИЗ
		|	РегистрСведений.МестонахождениеОСБухгалтерскийУчет КАК МестонахождениеОСБухгалтерскийУчет
		|ГДЕ
		|	МестонахождениеОСБухгалтерскийУчет.ОсновноеСредство = &ОсновноеСредство
		|	И МестонахождениеОСБухгалтерскийУчет.Организация = &Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	СобытияОС.Период КАК Период,
		|	МАКСИМУМ(МестонахождениеОСБухгалтерскийУчет.Период) КАК ПоследнийПериод
		|ПОМЕСТИТЬ МестонахождениеОСБухгалтерскийУчетСрезПоследнихПериодов
		|ИЗ
		|	СобытияОС КАК СобытияОС
		|		ЛЕВОЕ СОЕДИНЕНИЕ МестонахождениеОСБухгалтерскийУчет КАК МестонахождениеОСБухгалтерскийУчет
		|		ПО СобытияОС.Период >= МестонахождениеОСБухгалтерскийУчет.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	СобытияОС.Период
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	МестонахождениеОСБухгалтерскийУчетСрезПоследнихПериодов.Период КАК Период,
		|	МестонахождениеОСБухгалтерскийУчет.МОЛ КАК МОЛ,
		|	МестонахождениеОСБухгалтерскийУчет.Местонахождение КАК Местонахождение
		|ПОМЕСТИТЬ МестонахождениеОСБухгалтерскийУчетСрезПоследних
		|ИЗ
		|	МестонахождениеОСБухгалтерскийУчетСрезПоследнихПериодов КАК МестонахождениеОСБухгалтерскийУчетСрезПоследнихПериодов
		|		ЛЕВОЕ СОЕДИНЕНИЕ МестонахождениеОСБухгалтерскийУчет КАК МестонахождениеОСБухгалтерскийУчет
		|		ПО МестонахождениеОСБухгалтерскийУчетСрезПоследнихПериодов.ПоследнийПериод = МестонахождениеОСБухгалтерскийУчет.Период
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	СчетаБухгалтерскогоУчетаОС.Период КАК Период,
		|	ВЫБОР 
		|		КОГДА СчетаБухгалтерскогоУчетаОС.ГруппаФинансовогоУчета <> ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаВнеоборотныхАктивов.ПустаяСсылка)
		|			ТОГДА СчетаБухгалтерскогоУчетаОС.ГруппаФинансовогоУчета.СчетУчета
		|		ИНАЧЕ СчетаБухгалтерскогоУчетаОС.СчетУчета
		|	КОНЕЦ КАК СчетУчета,
		|	ВЫБОР 
		|		КОГДА СчетаБухгалтерскогоУчетаОС.ГруппаФинансовогоУчета <> ЗНАЧЕНИЕ(Справочник.ГруппыФинансовогоУчетаВнеоборотныхАктивов.ПустаяСсылка)
		|			ТОГДА СчетаБухгалтерскогоУчетаОС.ГруппаФинансовогоУчета.СчетУчетаАмортизации
		|		ИНАЧЕ СчетаБухгалтерскогоУчетаОС.СчетНачисленияАмортизации
		|	КОНЕЦ КАК СчетНачисленияАмортизации
		|ПОМЕСТИТЬ СчетаБухгалтерскогоУчетаОС
		|ИЗ
		|	РегистрСведений.СчетаБухгалтерскогоУчетаОС КАК СчетаБухгалтерскогоУчетаОС
		|ГДЕ
		|	СчетаБухгалтерскогоУчетаОС.ОсновноеСредство = &ОсновноеСредство
		|	И СчетаБухгалтерскогоУчетаОС.Организация = &Организация
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	СобытияОС.ПериодОстатков КАК ПериодОстатков,
		|	МАКСИМУМ(СчетаБухгалтерскогоУчетаОС.Период) КАК ПоследнийПериод
		|ПОМЕСТИТЬ СчетаБухгалтерскогоУчетаОССрезПоследнихПериодов
		|ИЗ
		|	СобытияОС КАК СобытияОС
		|		ЛЕВОЕ СОЕДИНЕНИЕ СчетаБухгалтерскогоУчетаОС КАК СчетаБухгалтерскогоУчетаОС
		|		ПО СобытияОС.ПериодОстатков >= СчетаБухгалтерскогоУчетаОС.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	СобытияОС.ПериодОстатков
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	СчетаБухгалтерскогоУчетаОССрезПоследнихПериодов.ПериодОстатков КАК ПериодОстатков,
		|	СчетаБухгалтерскогоУчетаОС.СчетУчета КАК СчетУчета,
		|	СчетаБухгалтерскогоУчетаОС.СчетНачисленияАмортизации КАК СчетНачисленияАмортизации
		|ПОМЕСТИТЬ СчетаБухгалтерскогоУчетаОССрезПоследних
		|ИЗ
		|	СчетаБухгалтерскогоУчетаОССрезПоследнихПериодов КАК СчетаБухгалтерскогоУчетаОССрезПоследнихПериодов
		|		ЛЕВОЕ СОЕДИНЕНИЕ СчетаБухгалтерскогоУчетаОС КАК СчетаБухгалтерскогоУчетаОС
		|		ПО СчетаБухгалтерскогоУчетаОССрезПоследнихПериодов.ПоследнийПериод = СчетаБухгалтерскогоУчетаОС.Период
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ХозрасчетныйОстаткиИОбороты.Период КАК Период,
		|	ХозрасчетныйОстаткиИОбороты.Счет КАК Счет,
		|	ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстатокДт КАК СуммаКонечныйОстатокДт,
		|	ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстатокКт КАК СуммаКонечныйОстатокКт,
		|	ХозрасчетныйОстаткиИОбороты.СуммаОборотДт КАК СуммаОборотДт,
		|	ХозрасчетныйОстаткиИОбороты.СуммаОборотКт КАК СуммаОборотКт
		|ПОМЕСТИТЬ ХозрасчетныйОстаткиИОбороты
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(
		|			,
		|			&Период,
		|			Регистратор,
		|			,
		|			Счет В
		|				(ВЫБРАТЬ РАЗЛИЧНЫЕ
		|					СчетаБухгалтерскогоУчетаОССрезПоследних.СчетУчета
		|				ИЗ
		|					СчетаБухгалтерскогоУчетаОССрезПоследних
		|			
		|				ОБЪЕДИНИТЬ ВСЕ
		|			
		|				ВЫБРАТЬ РАЗЛИЧНЫЕ
		|					СчетаБухгалтерскогоУчетаОССрезПоследних.СчетНачисленияАмортизации
		|				ИЗ
		|					СчетаБухгалтерскогоУчетаОССрезПоследних),
		|			ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОсновныеСредства),
		|			Организация = &Организация
		|				И Субконто1 = &ОсновноеСредство) КАК ХозрасчетныйОстаткиИОбороты
		|ГДЕ
		|	НЕ ХозрасчетныйОстаткиИОбороты.Регистратор = НЕОПРЕДЕЛЕНО
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	СобытияОС.ПериодОстатков КАК ПериодОстатков,
		|	ХозрасчетныйОстаткиИОбороты.Счет КАК Счет,
		|	МАКСИМУМ(ХозрасчетныйОстаткиИОбороты.Период) КАК ПоследнийПериод
		|ПОМЕСТИТЬ ХозрасчетныйОстаткиИОборотыСрезПоследнихПериодов
		|ИЗ
		|	СобытияОС КАК СобытияОС
		|		ЛЕВОЕ СОЕДИНЕНИЕ ХозрасчетныйОстаткиИОбороты КАК ХозрасчетныйОстаткиИОбороты
		|		ПО СобытияОС.ПериодОстатков >= ХозрасчетныйОстаткиИОбороты.Период
		|
		|СГРУППИРОВАТЬ ПО
		|	СобытияОС.ПериодОстатков,
		|	ХозрасчетныйОстаткиИОбороты.Счет
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ХозрасчетныйОстаткиИОборотыСрезПоследнихПериодов.ПериодОстатков КАК ПериодОстатков,
		|	ХозрасчетныйОстаткиИОбороты.Счет КАК Счет,
		|	ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстатокДт КАК СуммаКонечныйОстатокДт,
		|	ХозрасчетныйОстаткиИОбороты.СуммаКонечныйОстатокКт КАК СуммаКонечныйОстатокКт,
		|	ХозрасчетныйОстаткиИОбороты.СуммаОборотДт КАК СуммаОборотДт,
		|	ХозрасчетныйОстаткиИОбороты.СуммаОборотКт КАК СуммаОборотКт
		|ПОМЕСТИТЬ ХозрасчетныйОстаткиИОборотыСрезПоследних
		|ИЗ
		|	ХозрасчетныйОстаткиИОборотыСрезПоследнихПериодов КАК ХозрасчетныйОстаткиИОборотыСрезПоследнихПериодов
		|		ЛЕВОЕ СОЕДИНЕНИЕ ХозрасчетныйОстаткиИОбороты КАК ХозрасчетныйОстаткиИОбороты
		|		ПО ХозрасчетныйОстаткиИОборотыСрезПоследнихПериодов.ПоследнийПериод = ХозрасчетныйОстаткиИОбороты.Период
		|			И ХозрасчетныйОстаткиИОборотыСрезПоследнихПериодов.Счет = ХозрасчетныйОстаткиИОбороты.Счет
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ТИПЗНАЧЕНИЯ(СобытияОС.Регистратор) КАК НазваниеДокумента,
		|	СобытияОС.НомерДокумента КАК НомерДокумента,
		|	СобытияОС.Период КАК Период,
		|	СобытияОС.Событие КАК Событие,
		|	СобытияОС.Регистратор КАК Регистратор,
		|	МестонахождениеОСБухгалтерскийУчетСрезПоследних.МОЛ КАК МОЛ,
		|	МестонахождениеОСБухгалтерскийУчетСрезПоследних.Местонахождение КАК Местонахождение,
		|	СтоимостьОС.СуммаОборотКт КАК СтоимостьОборот,
		|	АмортизацияОС.СуммаОборотДт КАК АмортизацияОборот,
		|	ВЫБОР
		|		КОГДА СобытияОС.ВидСобытияОС В (ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.Списание), ЗНАЧЕНИЕ(Перечисление.ВидыСобытийОС.Передача))
		|			ТОГДА ЕСТЬNULL(СтоимостьОС.СуммаОборотКт, 0) - ЕСТЬNULL(АмортизацияОС.СуммаОборотДт, 0)
		|		ИНАЧЕ ЕСТЬNULL(СтоимостьОС.СуммаКонечныйОстатокДт, 0) - ЕСТЬNULL(АмортизацияОС.СуммаКонечныйОстатокКт, 0)
		|	КОНЕЦ КАК ОстаточнаяСтоимость
		|ИЗ
		|	СобытияОС КАК СобытияОС
		|		ЛЕВОЕ СОЕДИНЕНИЕ МестонахождениеОСБухгалтерскийУчетСрезПоследних КАК МестонахождениеОСБухгалтерскийУчетСрезПоследних
		|		ПО СобытияОС.Период = МестонахождениеОСБухгалтерскийУчетСрезПоследних.Период
		|		ЛЕВОЕ СОЕДИНЕНИЕ СчетаБухгалтерскогоУчетаОССрезПоследних КАК СчетаБухгалтерскогоУчетаОССрезПоследних
		|		ПО СобытияОС.ПериодОстатков = СчетаБухгалтерскогоУчетаОССрезПоследних.ПериодОстатков
		|		ЛЕВОЕ СОЕДИНЕНИЕ ХозрасчетныйОстаткиИОборотыСрезПоследних КАК СтоимостьОС
		|		ПО (СчетаБухгалтерскогоУчетаОССрезПоследних.ПериодОстатков = СтоимостьОС.ПериодОстатков)
		|			И (СчетаБухгалтерскогоУчетаОССрезПоследних.СчетУчета = СтоимостьОС.Счет)
		|		ЛЕВОЕ СОЕДИНЕНИЕ ХозрасчетныйОстаткиИОборотыСрезПоследних КАК АмортизацияОС
		|		ПО (СчетаБухгалтерскогоУчетаОССрезПоследних.ПериодОстатков = АмортизацияОС.ПериодОстатков)
		|			И (СчетаБухгалтерскогоУчетаОССрезПоследних.СчетНачисленияАмортизации = АмортизацияОС.Счет)";

		СписокЗапросов.Добавить(ТекстЗапроса);
		
	КонецЕсли; 
	
	Запрос.Текст = СтрСоединить(СписокЗапросов, ОбщегоНазначения.РазделительПакетаЗапросов());
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Возврат Выборка;

КонецФункции

//-- Локализация

#КонецОбласти

#Область ФормаЭлемента

//++ Локализация

Процедура КодОКОФПриИзменении(Форма)

	Объект = Форма.Объект;
	
	Объект.АмортизационнаяГруппа = РегистрыСведений.АмортизационныеГруппыОКОФ.ПолучитьАмортизационнуюГруппу(Объект.КодПоОКОФ);
	
	ЗаполнитьПодсказкуКодОКОФ(Форма);

КонецПроцедуры

Процедура ОбработатьВыборКодаПоОКОФ(Форма, ВыбранноеЗначение)
	
	Если ТипЗнч(ВыбранноеЗначение) <> Тип("Структура") Тогда
		Возврат;
	КонецЕсли;
	
	Объект = Форма.Объект;
	
	СтарыйОКОФ = Объект.КодПоОКОФ;
	СтараяАмортизационнаяГруппа = Объект.АмортизационнаяГруппа;
	
	КодПоОКОФ = ВыбранноеЗначение.ОКОФ;
	АмортизационнаяГруппа = ВыбранноеЗначение.АмортизационнаяГруппа;
	
	Объект.КодПоОКОФ = КодПоОКОФ;
	Объект.АмортизационнаяГруппа = АмортизационнаяГруппа;
	
	Форма.Модифицированность =
		Форма.Модифицированность
		Или СтарыйОКОФ <> КодПоОКОФ
		Или СтараяАмортизационнаяГруппа <> АмортизационнаяГруппа;
		
	ЗаполнитьПодсказкуКодОКОФ(Форма);
	
КонецПроцедуры

Процедура ЗаполнитьПодсказкуКодОКОФ(Форма)
	
	Объект = Форма.Объект;

	ТекстПодсказки = НСтр("ru = 'Код по классификатору основных фондов'");
	
	Если ЗначениеЗаполнено(Объект.КодПоОКОФ) Тогда
		ТекстПодсказки = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(Объект.КодПоОКОФ, "Наименование");
	КонецЕсли; 
	
	Форма.Элементы.КодПоОКОФ.Подсказка = ТекстПодсказки;
	
КонецПроцедуры

Процедура ДрагоценныеМатериалыДрагоценныйМатериалПриИзменении(Форма)
	
	Элементы = Форма.Элементы;
	Объект = Форма.Объект;
	
	ТекущаяСтрока = Элементы.ДрагоценныеМатериалы.ТекущаяСтрока;
	ТекущиеДанные = Объект.ДрагоценныеМатериалы.НайтиПоИдентификатору(ТекущаяСтрока);
	
	Если ТекущиеДанные = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	Если ЗначениеЗаполнено(ТекущиеДанные.ДрагоценныйМатериал) Тогда
		ТекущиеДанные.ЕдиницаИзмерения = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(ТекущиеДанные.ДрагоценныйМатериал, "ЕдиницаИзмерения");
	Иначе
		ТекущиеДанные.ЕдиницаИзмерения = ПредопределенноеЗначение("Справочник.УпаковкиЕдиницыИзмерения.ПустаяСсылка");
	КонецЕсли; 
	
КонецПроцедуры

//-- Локализация

#КонецОбласти

#Область ОбновлениеИнформационнойБазы

Процедура ДополнитьТекстЗапросаРегистрацииДанныхКОбработке(СписокЗапросов) Экспорт

	//++ Локализация
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ОбъектыЭксплуатации.Ссылка
	|ИЗ
	|	Справочник.ОбъектыЭксплуатации КАК ОбъектыЭксплуатации
	|ГДЕ
	|	НЕ &ИспользоватьРеглУчет
	|	И (ОбъектыЭксплуатации.ГруппаОС <> ЗНАЧЕНИЕ(Перечисление.ГруппыОС.ПустаяСсылка)
	|			ИЛИ ОбъектыЭксплуатации.АмортизационнаяГруппа <> ЗНАЧЕНИЕ(Перечисление.АмортизационныеГруппы.ПустаяСсылка)
	|			ИЛИ ОбъектыЭксплуатации.КодПоОКОФ <> ЗНАЧЕНИЕ(Справочник.ОбщероссийскийКлассификаторОсновныхФондов.ПустаяСсылка)
	|			ИЛИ ОбъектыЭксплуатации.ШифрПоЕНАОФ <> ЗНАЧЕНИЕ(Справочник.ЕдиныеНормыАмортизационныхОтчисленийОсновныхФондов.ПустаяСсылка))";
	СписокЗапросов.Добавить(ТекстЗапроса);
	//-- Локализация
	
КонецПроцедуры

Процедура ОбработатьДанныеДляПереходаНаНовуюВерсию(ДанныеОбъекта, ДопПараметры) Экспорт
	
	//++ Локализация
	
	Если НЕ ДопПараметры.Свойство("ИспользоватьРеглУчет") Тогда
		ДопПараметры.Вставить("ИспользоватьРеглУчет", Константы.ИспользоватьРеглУчет.Получить());
	КонецЕсли; 
	
	Если НЕ ДопПараметры.ИспользоватьРеглУчет Тогда
		
		Если ЗначениеЗаполнено(ДанныеОбъекта.ГруппаОС) Тогда
			ДанныеОбъекта.ГруппаОС = Перечисления.ГруппыОС.ПустаяСсылка();
		КонецЕсли; 
		Если ЗначениеЗаполнено(ДанныеОбъекта.АмортизационнаяГруппа) Тогда
			ДанныеОбъекта.АмортизационнаяГруппа = Перечисления.АмортизационныеГруппы.ПустаяСсылка();
		КонецЕсли; 
		Если ЗначениеЗаполнено(ДанныеОбъекта.КодПоОКОФ) Тогда
			ДанныеОбъекта.КодПоОКОФ = Справочники.ОбщероссийскийКлассификаторОсновныхФондов.ПустаяСсылка();
		КонецЕсли; 
		Если ЗначениеЗаполнено(ДанныеОбъекта.ШифрПоЕНАОФ) Тогда
			ДанныеОбъекта.ШифрПоЕНАОФ = Справочники.ЕдиныеНормыАмортизационныхОтчисленийОсновныхФондов.ПустаяСсылка();
		КонецЕсли; 
		
	КонецЕсли;
	//-- Локализация

КонецПроцедуры

#КонецОбласти

#КонецОбласти
